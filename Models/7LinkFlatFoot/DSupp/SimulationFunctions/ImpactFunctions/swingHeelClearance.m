function out = swingHeelClearance(q,qdot)
%Returns distance from slope and velocity of the swing heel of the biped
%   out(1) = height
%   out(2) = velocity
global flowdata   
    la = flowdata.Parameters.Biped.la;
    l1 = flowdata.Parameters.Biped.ls;
    l2 = flowdata.Parameters.Biped.lt;
    slope = flowdata.Parameters.Environment.slope;
    
    x = [q;qdot];
    out(1) = la.*cos(x(3))+l1.*cos(x(3)+x(4))+l2.*cos(x(3)+x(4)+x(5))+( ...
    -1).*l2.*cos(x(3)+x(4)+x(5)+x(6))+(-1).*l1.*cos(x(3)+x(4)+x( ...
    5)+x(6)+x(7))+(-1).*la.*cos(x(3)+x(4)+x(5)+x(6)+x(7)+x(8))+( ...
    -1).*tan(slope).*((-1).*la.*sin(x(3))+(-1).*l1.*sin(x(3)+x( ...
    4))+(-1).*l2.*sin(x(3)+x(4)+x(5))+l2.*sin(x(3)+x(4)+x(5)+x( ...
    6))+l1.*sin(x(3)+x(4)+x(5)+x(6)+x(7))+la.*sin(x(3)+x(4)+x(5) ...
    +x(6)+x(7)+x(8))+x(1))+x(2);

    out(2) = x(10)+(-1).*la.*sin(x(3)).*x(11)+(-1).*l1.*sin(x(3)+x(4)).*( ...
    x(11)+x(12))+(-1).*l2.*sin(x(3)+x(4)+x(5)).*(x(11)+x(12)+x( ...
    13))+l2.*sin(x(3)+x(4)+x(5)+x(6)).*(x(11)+x(12)+x(13)+x(14)) ...
    +l1.*sin(x(3)+x(4)+x(5)+x(6)+x(7)).*(x(11)+x(12)+x(13)+x(14) ...
    +x(15))+la.*sin(x(3)+x(4)+x(5)+x(6)+x(7)+x(8)).*(x(11)+x(12) ...
    +x(13)+x(14)+x(15)+x(16))+(-1).*tan(slope).*(x(9)+(-1).*la.* ...
    cos(x(3)).*x(11)+(-1).*l1.*cos(x(3)+x(4)).*(x(11)+x(12))+( ...
    -1).*l2.*cos(x(3)+x(4)+x(5)).*(x(11)+x(12)+x(13))+l2.*cos(x( ...
    3)+x(4)+x(5)+x(6)).*(x(11)+x(12)+x(13)+x(14))+l1.*cos(x(3)+ ...
    x(4)+x(5)+x(6)+x(7)).*(x(11)+x(12)+x(13)+x(14)+x(15))+la.* ...
    cos(x(3)+x(4)+x(5)+x(6)+x(7)+x(8)).*(x(11)+x(12)+x(13)+x(14) ...
    +x(15)+x(16)));
end

