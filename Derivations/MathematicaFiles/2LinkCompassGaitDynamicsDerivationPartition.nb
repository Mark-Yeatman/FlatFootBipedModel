(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    151275,       3884]
NotebookOptionsPosition[    147425,       3761]
NotebookOutlinePosition[    147965,       3781]
CellTagsIndexPosition[    147922,       3778]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Point Foot Open Chain Kinematics", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}, {
   3.7685736312280703`*^9, 3.768573641896326*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "spell"}], ",", 
    RowBox[{"General", "::", "spell1"}], ",", 
    StyleBox[
     RowBox[{"Get", "::", "noopen"}], "MessageName"], 
    StyleBox[",", "MessageName"], 
    StyleBox[
     RowBox[{"Needs", "::", "nocont"}], "MessageName"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Screws`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<Screws`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"_", "\[Element]", "Reals"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.433011357994742*^9, {3.5049628597113647`*^9, 3.50496286452464*^9}, {
   3.5263890533940296`*^9, 3.5263890535870295`*^9}, {3.5431470386141915`*^9, 
   3.5431470437021914`*^9}, {3.591555409577234*^9, 3.591555414649741*^9}, {
   3.7354012097992954`*^9, 3.735401214596718*^9}, {3.7639202081916122`*^9, 
   3.763920219149975*^9}, {3.763920697399998*^9, 3.7639207159604616`*^9}, {
   3.763920857225813*^9, 3.7639208671316104`*^9}, {3.763920901958491*^9, 
   3.763920902488796*^9}, {3.763921706626407*^9, 3.76392171601926*^9}, {
   3.7669341267785344`*^9, 3.766934127562935*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"EndPackage", "::", "noctx"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"No previous context defined. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/EndPackage/noctx\\\", ButtonNote -> \
\\\"EndPackage::noctx\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.7976923075032244`*^9, 3.7976983377050047`*^9, 
  3.7976983873529205`*^9, 3.797698735208359*^9, 3.797698933251013*^9, 
  3.7976990148218775`*^9, 3.797699115671711*^9, 3.7976991832846036`*^9, 
  3.797699233980521*^9, 3.797699272744458*^9, 3.797699328727374*^9, 
  3.7976994178652263`*^9, 3.797699609642111*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"x", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x3", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x4", "[", "t", "]"}], "}"}]}], "}"}]}], "]"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{"x", ",", " ", "y", ",", " ", 
    RowBox[{"ankle", " ", "angle"}], ",", " ", 
    RowBox[{"hip", " ", "angle"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"xdot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"x", ",", "t"}], "]"}]}], " ", "]"}]}], "Input",
 CellChangeTimes->{
  3.5111737472017937`*^9, {3.511173782073788*^9, 3.5111737868600616`*^9}, {
   3.5111755940464272`*^9, 3.511175600408791*^9}, {3.520686131703125*^9, 
   3.520686135875*^9}, {3.520686309671875*^9, 3.520686312484375*^9}, {
   3.520687115453125*^9, 3.5206871275625*^9}, {3.52078867884375*^9, 
   3.52078872540625*^9}, {3.520857852828125*^9, 3.520857856765625*^9}, {
   3.521820034578125*^9, 3.52182003665625*^9}, {3.521820194515625*^9, 
   3.52182019925*^9}, {3.521911060609375*^9, 3.52191106496875*^9}, 
   3.5219945113125*^9, {3.523028145328125*^9, 3.523028147203125*^9}, 
   3.523028568734375*^9, {3.523033556203125*^9, 3.5230335580625*^9}, {
   3.52303366240625*^9, 3.523033664046875*^9}, {3.5232996586875*^9, 
   3.523299669890625*^9}, 3.523299712796875*^9, {3.52330022171875*^9, 
   3.523300234421875*^9}, {3.52330028559375*^9, 3.52330029028125*^9}, 
   3.5233008249375*^9, {3.523360415484375*^9, 3.523360421828125*^9}, {
   3.523380309234375*^9, 3.52338031990625*^9}, {3.523380358796875*^9, 
   3.523380364234375*^9}, {3.5287165611401763`*^9, 3.5287165746088295`*^9}, {
   3.543073868103307*^9, 3.543073894812307*^9}, 3.5430739902623067`*^9, {
   3.5430742662443066`*^9, 3.543074273445307*^9}, 3.5430744729683065`*^9, {
   3.5430748729733067`*^9, 3.5430748749423065`*^9}, {3.555095285078673*^9, 
   3.5550952976686726`*^9}, {3.5553255793781047`*^9, 3.555325590112178*^9}, 
   3.5559492285885787`*^9, {3.587054558588013*^9, 3.587054560969251*^9}, {
   3.7639210046785345`*^9, 3.763921006646368*^9}, {3.7639223376326623`*^9, 
   3.7639223408171253`*^9}, {3.7639888827120976`*^9, 3.763988883260669*^9}, {
   3.7639889168895807`*^9, 3.7639889213377137`*^9}, {3.7668387110156374`*^9, 
   3.766838742199313*^9}, {3.7668390632542467`*^9, 3.7668390653021955`*^9}, {
   3.76685038634461*^9, 3.7668503867767572`*^9}, {3.7669333887464466`*^9, 
   3.7669334534522886`*^9}, {3.766934137961943*^9, 3.76693415384387*^9}, 
   3.770734864961463*^9, {3.797690964218771*^9, 3.7976909830647173`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"x1", "[", "t", "]"}]},
     {
      RowBox[{"x2", "[", "t", "]"}]},
     {
      RowBox[{"x3", "[", "t", "]"}]},
     {
      RowBox[{"x4", "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7669341567528462`*^9, 3.7669344262757835`*^9, 3.7670278377585034`*^9, 
   3.767032930546091*^9, 3.768654406616271*^9, 3.7693637236710835`*^9, 
   3.7693639960108194`*^9, 3.769432017113268*^9, 3.77074308759962*^9, 
   3.770743162061582*^9, 3.7707432238274546`*^9, {3.770747795693262*^9, 
   3.7707478243545227`*^9}, 3.7767785313778725`*^9, 3.7767798093770647`*^9, 
   3.7767798405394015`*^9, 3.778438691621924*^9, 3.794493530379877*^9, 
   3.7944935771231413`*^9, 3.7944944196718736`*^9, 3.794494454448018*^9, 
   3.7944945796954846`*^9, {3.7944950611541615`*^9, 3.7944951172581654`*^9}, 
   3.7944961247512803`*^9, 3.797691687237638*^9, 3.797692094674797*^9, {
   3.797692284215269*^9, 3.7976923076431947`*^9}, 3.7976983378312025`*^9, 
   3.7976983874749513`*^9, 3.7976987353383303`*^9, 3.7976989333750134`*^9, 
   3.797699014982875*^9, 3.797699115797711*^9, 3.7976991834146013`*^9, 
   3.7976992342705483`*^9, 3.7976992728894596`*^9, 3.7976993288603992`*^9, 
   3.797699417995226*^9, 3.797699609759141*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       SuperscriptBox["x1", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]},
     {
      RowBox[{
       SuperscriptBox["x2", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]},
     {
      RowBox[{
       SuperscriptBox["x3", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]},
     {
      RowBox[{
       SuperscriptBox["x4", "\[Prime]",
        MultilineFunction->None], "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7669341567528462`*^9, 3.7669344262757835`*^9, 3.7670278377585034`*^9, 
   3.767032930546091*^9, 3.768654406616271*^9, 3.7693637236710835`*^9, 
   3.7693639960108194`*^9, 3.769432017113268*^9, 3.77074308759962*^9, 
   3.770743162061582*^9, 3.7707432238274546`*^9, {3.770747795693262*^9, 
   3.7707478243545227`*^9}, 3.7767785313778725`*^9, 3.7767798093770647`*^9, 
   3.7767798405394015`*^9, 3.778438691621924*^9, 3.794493530379877*^9, 
   3.7944935771231413`*^9, 3.7944944196718736`*^9, 3.794494454448018*^9, 
   3.7944945796954846`*^9, {3.7944950611541615`*^9, 3.7944951172581654`*^9}, 
   3.7944961247512803`*^9, 3.797691687237638*^9, 3.797692094674797*^9, {
   3.797692284215269*^9, 3.7976923076431947`*^9}, 3.7976983378312025`*^9, 
   3.7976983874749513`*^9, 3.7976987353383303`*^9, 3.7976989333750134`*^9, 
   3.797699014982875*^9, 3.797699115797711*^9, 3.7976991834146013`*^9, 
   3.7976992342705483`*^9, 3.7976992728894596`*^9, 3.7976993288603992`*^9, 
   3.797699417995226*^9, 3.7976996097651105`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ax1", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax2", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax3", " ", "=", " ", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax4", " ", "=", " ", 
   RowBox[{"RevoluteTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{"a", "+", "b1"}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axzero", " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e1", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax1", ",", 
      RowBox[{"x1", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e2", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax2", ",", 
      RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e3", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax3", ",", 
      RowBox[{"x3", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e4", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax4", ",", 
      RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.520686144890625*^9, 3.520686145203125*^9}, {
   3.52068617653125*^9, 3.520686205625*^9}, {3.520686284921875*^9, 
   3.520686305984375*^9}, {3.520686374484375*^9, 3.520686441609375*^9}, {
   3.52068650903125*^9, 3.520686509140625*^9}, {3.52068656871875*^9, 
   3.520686617546875*^9}, {3.5206873421875*^9, 3.520687418140625*^9}, {
   3.5207688911875*^9, 3.520768891421875*^9}, {3.5208577891875*^9, 
   3.5208577938125*^9}, {3.52182001190625*^9, 3.521820023734375*^9}, {
   3.521911082890625*^9, 3.52191115175*^9}, {3.52191125971875*^9, 
   3.521911294796875*^9}, {3.521911335375*^9, 3.5219113548125*^9}, {
   3.5219119563125*^9, 3.521911956390625*^9}, {3.521994532609375*^9, 
   3.521994535875*^9}, {3.52206939596875*^9, 3.5220694045625*^9}, {
   3.523028084703125*^9, 3.523028115890625*^9}, 3.523028291140625*^9, 
   3.523033323140625*^9, 3.523033450765625*^9, {3.52303353259375*^9, 
   3.5230335539375*^9}, {3.5230373085*^9, 3.52303737340625*^9}, {
   3.523037467328125*^9, 3.52303746903125*^9}, 3.52330047*^9, {
   3.523358999328125*^9, 3.52335906684375*^9}, {3.523360273125*^9, 
   3.523360357953125*^9}, {3.5233608009375*^9, 3.523360804421875*^9}, {
   3.52336423246875*^9, 3.52336423984375*^9}, 3.528716608959394*^9, {
   3.5378114879773455`*^9, 3.5378114882175856`*^9}, {3.539014808319905*^9, 
   3.5390148139360275`*^9}, {3.543073943307307*^9, 3.543074019945307*^9}, {
   3.5430740586903067`*^9, 3.543074064726307*^9}, {3.543075246569307*^9, 
   3.5430752470013065`*^9}, {3.5431422985871916`*^9, 3.543142308314192*^9}, {
   3.5439277592067757`*^9, 3.5439277644517756`*^9}, {3.5439278106917753`*^9, 
   3.5439278108357754`*^9}, {3.5551529968463793`*^9, 3.555153041439379*^9}, {
   3.5553255954747143`*^9, 3.555325607990966*^9}, {3.555949225987579*^9, 
   3.5559492261145787`*^9}, 3.763920382649495*^9, {3.766837473854662*^9, 
   3.766837499439719*^9}, {3.7668375300314803`*^9, 3.7668377108155165`*^9}, {
   3.766837749693593*^9, 3.7668378234201884`*^9}, {3.7668383903285275`*^9, 
   3.7668384059285145`*^9}, {3.766925069113969*^9, 3.766925123290484*^9}, {
   3.7707348741341095`*^9, 3.7707348856316285`*^9}, {3.7707350337783594`*^9, 
   3.770735040608425*^9}, 3.776779836037222*^9, {3.794495082033045*^9, 
   3.7944950833625417`*^9}, 3.797691526156103*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Reference", " ", "configurations"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gst00", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "b1", ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"stance", " ", "shank", " ", "CoM", " ", "pos"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gst01", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"b1", "+", "a"}], ",", " ", "0"}], "}"}]}], "]"}]}], ";"}], 
   "  ", 
   RowBox[{"(*", 
    RowBox[{"hip", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gst02", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "b2", ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"swing", " ", "shank", " ", "CoM", " ", "pos"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp0", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"stance", " ", "foot", " ", "pos"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp1", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"a", "+", "b1"}], ",", " ", "0"}], "}"}]}], "]"}]}], ";"}], 
   "  ", 
   RowBox[{"(*", 
    RowBox[{"hip", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp2", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"swing", " ", "point", " ", "foot", " ", "pos"}], "*)"}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.52068675271875*^9, 3.5206868401875*^9}, {
   3.52068688309375*^9, 3.520686884765625*^9}, {3.5206869316875*^9, 
   3.52068695546875*^9}, {3.52068703525*^9, 3.5206870995*^9}, {
   3.52068721059375*^9, 3.5206872309375*^9}, {3.520687329875*^9, 
   3.520687335984375*^9}, {3.520687447921875*^9, 3.520687482640625*^9}, {
   3.52085775021875*^9, 3.5208577569375*^9}, {3.52182002690625*^9, 
   3.521820029890625*^9}, {3.52199454090625*^9, 3.5219945435625*^9}, {
   3.521994576609375*^9, 3.521994577125*^9}, 3.522069407859375*^9, {
   3.52302817175*^9, 3.52302817784375*^9}, {3.52302821046875*^9, 
   3.523028219296875*^9}, {3.52302827453125*^9, 3.523028289421875*^9}, {
   3.52303357528125*^9, 3.523033624796875*^9}, {3.5232999903125*^9, 
   3.523300034796875*^9}, {3.52330072346875*^9, 3.52330075775*^9}, {
   3.5387617592355986`*^9, 3.538761759396615*^9}, {3.5387617916248374`*^9, 
   3.5387617925049257`*^9}, {3.543074082165307*^9, 3.543074148335307*^9}, {
   3.543074210203307*^9, 3.5430743652183065`*^9}, {3.543074567731307*^9, 
   3.543074573234307*^9}, {3.5551530722213793`*^9, 3.555153123128379*^9}, {
   3.5551548714599023`*^9, 3.555154880689748*^9}, {3.7638166935451756`*^9, 
   3.76381674183117*^9}, {3.7639203529556055`*^9, 3.7639203532584653`*^9}, {
   3.766837860997422*^9, 3.76683788583599*^9}, {3.766838103724718*^9, 
   3.7668381441078825`*^9}, {3.7668381826039295`*^9, 
   3.7668383214008665`*^9}, {3.7668387736225224`*^9, 
   3.7668389790774717`*^9}, {3.7668478961501436`*^9, 3.766847912070002*^9}, {
   3.766847992231434*^9, 3.766847996488286*^9}, {3.766848831585499*^9, 
   3.7668488424337807`*^9}, {3.766925134650326*^9, 3.7669251923378916`*^9}, {
   3.77073490216096*^9, 3.7707349615843625`*^9}, {3.7707350355222645`*^9, 
   3.7707350393125973`*^9}, {3.776778475905078*^9, 3.776778487653859*^9}, 
   3.776779803474511*^9, {3.7944949724086685`*^9, 3.7944949734866576`*^9}, {
   3.7944950138289576`*^9, 3.7944950216098785`*^9}, {3.794495053261383*^9, 
   3.794495054646903*^9}, {3.7976915078661165`*^9, 3.797691519336076*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J0", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], ",", " ", "gst00"}], "]"}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], "       ", ",", " ", 
      "gst01"}], "]"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", "=", " ", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], "       ", ",", " ", 
      "gst02"}], "]"}], "//", "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7668383315824933`*^9, 3.766838359803605*^9}, {
   3.7668384106181993`*^9, 3.7668384846168895`*^9}, {3.770734969281283*^9, 
   3.7707349844005995`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 3.5431473723201914`*^9}],

Cell[CellGroupData[{

Cell["Mass Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.7638166458802586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genM0", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Ms1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Ms1", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Ms1", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Isx1", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy1", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz1"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mh", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mh", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Mh", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     "    ", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     "     ", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM2", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Ms2", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Ms2", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", " ", "Ms2", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "Isx2", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "Isy2", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "Isz2"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
  3.7668385449517975`*^9, 3.7668386580442085`*^9}, {3.7707350304975376`*^9, 
  3.7707350514102287`*^9}, {3.7707351006543536`*^9, 3.7707351038872805`*^9}, {
  3.797691420230405*^9, 3.797691439047327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Mmatrix", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "J0", "]"}], ".", "genM0", ".", "J0"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J1", "]"}], ".", "genM1", ".", "J1"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J2", "]"}], ".", "genM2", ".", "J2"}]}]}], 
   "]"}], "//", "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{"KE", " ", "=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{
     RowBox[{"Transpose", "[", "xdot", "]"}], ".", "Mmatrix", ".", "xdot"}]}],
    " ", "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
   3.766839392453774*^9, 3.766839392740121*^9}, {3.7668447646323347`*^9, 
   3.766844766133748*^9}, {3.76685019324174*^9, 3.7668501933860693`*^9}, 
   3.7668502870130854`*^9, 3.7668547114111614`*^9, 3.7669255188766155`*^9, {
   3.7707351083093777`*^9, 3.770735108608057*^9}, 3.778499994270912*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]},
     {"0", 
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Isz1", "+", "Isz2", "+", 
       RowBox[{
        SuperscriptBox["b1", "2"], " ", "Ms1"}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7669292766815186`*^9, 3.7669338301964054`*^9, 3.766934216714278*^9, 
   3.7686544185035152`*^9, 3.7693637339879675`*^9, 3.7707430880935583`*^9, 
   3.7707431624586353`*^9, 3.7707432242400513`*^9, 3.770747838316817*^9, 
   3.776778532485098*^9, 3.776779810387252*^9, 3.776779841096185*^9, 
   3.7784386922512712`*^9, 3.778499997902171*^9, 3.794493531025714*^9, 
   3.7944935776851387`*^9, 3.794494420161897*^9, 3.7944944550250387`*^9, 
   3.794494580211454*^9, {3.7944950624281483`*^9, 3.7944951176421604`*^9}, 
   3.7944961253032737`*^9, 3.797691688451635*^9, 3.797692095089794*^9, {
   3.797692284524259*^9, 3.797692308758191*^9}, 3.797698338958033*^9, 
   3.7976983885889187`*^9, 3.7976987364073267`*^9, 3.7976989344740114`*^9, 
   3.797699016022874*^9, 3.797699116895709*^9, 3.7976991844645996`*^9, 
   3.7976992353155184`*^9, 3.7976992739144564`*^9, 3.79769932994637*^9, 
   3.797699419100254*^9, 3.797699610847109*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["x1", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["x2", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Isz1", "+", "Isz2", "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", "Mh"}], "+", 
         RowBox[{"2", " ", "a", " ", "b1", " ", "Mh"}], "+", 
         RowBox[{
          SuperscriptBox["b1", "2"], " ", "Mh"}], "+", 
         RowBox[{
          SuperscriptBox["b1", "2"], " ", "Ms1"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"a", "+", "b1"}], ")"}], "2"]}], "-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"a", "+", "b1"}], ")"}], " ", "b2"}], "+", 
            SuperscriptBox["b2", "2"]}], ")"}], " ", "Ms2"}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["x3", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"Isz2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}], 
         "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{
        SuperscriptBox["x4", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Isz2", "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}], 
        ")"}], " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["x4", "\[Prime]",
          MultilineFunction->None], "[", "t", "]"}], "2"]}], "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["x2", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
             RowBox[{"b1", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}],
       "+", 
      RowBox[{"2", " ", 
       RowBox[{
        SuperscriptBox["x1", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
             RowBox[{"b1", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], 
          " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
        ")"}]}]}], ")"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.7669292766815186`*^9, 3.7669338301964054`*^9, 3.766934216714278*^9, 
   3.7686544185035152`*^9, 3.7693637339879675`*^9, 3.7707430880935583`*^9, 
   3.7707431624586353`*^9, 3.7707432242400513`*^9, 3.770747838316817*^9, 
   3.776778532485098*^9, 3.776779810387252*^9, 3.776779841096185*^9, 
   3.7784386922512712`*^9, 3.778499997902171*^9, 3.794493531025714*^9, 
   3.7944935776851387`*^9, 3.794494420161897*^9, 3.7944944550250387`*^9, 
   3.794494580211454*^9, {3.7944950624281483`*^9, 3.7944951176421604`*^9}, 
   3.7944961253032737`*^9, 3.797691688451635*^9, 3.797692095089794*^9, {
   3.797692284524259*^9, 3.797692308758191*^9}, 3.797698338958033*^9, 
   3.7976983885889187`*^9, 3.7976987364073267`*^9, 3.7976989344740114`*^9, 
   3.797699016022874*^9, 3.797699116895709*^9, 3.7976991844645996`*^9, 
   3.7976992353155184`*^9, 3.7976992739144564`*^9, 3.79769932994637*^9, 
   3.797699419100254*^9, 3.797699618181097*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["C Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cmtx", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cmtx", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Mmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], "]"}],
          "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ")"}], " ", 
            RowBox[{"xdot", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Cmtx", " ", "=", " ", 
   RowBox[{"Cmtx", "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.520791335*^9, 3.520791401109375*^9}, {
   3.520791435046875*^9, 3.52079155540625*^9}, {3.520791602453125*^9, 
   3.520791651296875*^9}, {3.5207916853125*^9, 3.520791710046875*^9}, {
   3.520857930671875*^9, 3.520857946375*^9}, {3.521820137609375*^9, 
   3.52182014315625*^9}, {3.52189796709375*^9, 3.521898017515625*^9}, {
   3.523028605546875*^9, 3.52302860590625*^9}, {3.523380346921875*^9, 
   3.52338035309375*^9}, 3.766933766852949*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Cmtx", "]"}]], "Input",
 CellChangeTimes->{{3.5207916539375*^9, 3.52079166959375*^9}, {
   3.520857961375*^9, 3.520857962796875*^9}, 3.740490029073041*^9, 
   3.766844233882579*^9, {3.7668447985181684`*^9, 3.7668448046624446`*^9}, 
   3.7668488996676607`*^9, 3.7669255161247463`*^9, 3.766933762391165*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
               RowBox[{"b1", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], 
             " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}]}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
               RowBox[{"b1", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x4", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.766929613808268*^9, 3.7669340197500277`*^9, 3.7669343594172645`*^9, 
   3.7686545720518184`*^9, 3.7693638849649754`*^9, 3.770743090583227*^9, 
   3.7707431650073814`*^9, 3.77074322674232*^9, 3.770747840840565*^9, 
   3.776778543288987*^9, {3.776779821665637*^9, 3.77677984738761*^9}, 
   3.778438697213497*^9, 3.7944935359286876`*^9, 3.7944935828303013`*^9, 
   3.7944944250768137`*^9, 3.7944944599019556`*^9, 3.7944945851319494`*^9, {
   3.794495087208085*^9, 3.794495121724126*^9}, 3.794496129664157*^9, 
   3.7976916971386356`*^9, 3.7976920995828137`*^9, 3.7976922867132835`*^9, 
   3.7976923174771957`*^9, 3.7976983475329895`*^9, 3.7976983972869034`*^9, 
   3.7976987451223116`*^9, 3.797698943119996*^9, 3.797699024557888*^9, 
   3.7976991255056934`*^9, 3.7976991930635867`*^9, 3.7976992439525127`*^9, 
   3.797699282494444*^9, 3.797699339049384*^9, 3.7976994278182116`*^9, 
   3.7976996195280952`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gstS", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "e3", ".", "gst00"}], "//", 
     "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gstH", " ", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gst01"}], "//", 
     "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gstS2", " ", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gst02"}], "//", 
     "FullSimplify"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.43635395903125*^9, 3.43635397253125*^9}, {
   3.520767215140625*^9, 3.52076722809375*^9}, {3.520767277078125*^9, 
   3.52076737496875*^9}, {3.523028701984375*^9, 3.523028714265625*^9}, {
   3.5230287605*^9, 3.523028792140625*^9}, {3.5431471447521915`*^9, 
   3.5431471594071913`*^9}, {3.5551549654476967`*^9, 3.555154996476901*^9}, {
   3.5553272319803486`*^9, 3.555327234011552*^9}, {3.740489941059808*^9, 
   3.7404899442586355`*^9}, {3.7668391482307367`*^9, 
   3.7668391545653667`*^9}, {3.766839191172443*^9, 3.7668392480525646`*^9}, 
   3.766839439428705*^9, 3.766839567380932*^9, {3.7668443586830606`*^9, 
   3.766844437688098*^9}, {3.770735152207979*^9, 3.770735163327652*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gpF", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "gp0"}], "//", "FullSimplify"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gpH", " ", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gp1"}], "//", 
     "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"gpF2", " ", "=", " ", 
    RowBox[{
     RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gp2"}], "//", 
     "FullSimplify"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7707430027246895`*^9, 3.770743004773883*^9}, {
  3.770743118293001*^9, 3.7707431277331343`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gravity", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}, 
   3.76684801883489*^9, {3.7668489333256397`*^9, 3.7668489356007504`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"PE", " ", "=", "  ", 
  RowBox[{
   RowBox[{
    RowBox[{"Ms1", "*", "g", "*", 
     RowBox[{"gstS", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
    RowBox[{"Mh", "*", "g", "*", 
     RowBox[{"gstH", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}]}], "+", 
    RowBox[{"Ms2", "*", "g", "*", 
     RowBox[{"gstS2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}], " ", "//", 
   "FullSimplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Nvect", " ", "=", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"D", "[", 
       RowBox[{"PE", ",", 
        RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}]}], ";"}], 
  " ", "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7668500685384293`*^9, 3.766850128622355*^9}, {
   3.7668501669474573`*^9, 3.7668501891299787`*^9}, {3.766925222079686*^9, 
   3.7669252297190833`*^9}, 3.766925513805091*^9, 3.766933727203929*^9, {
   3.7707351684992986`*^9, 3.770735175135661*^9}, {3.770743135750019*^9, 
   3.770743135955907*^9}, 3.770745828154647*^9, {3.79769251896666*^9, 
   3.7976925211566515`*^9}}],

Cell[BoxData[
 RowBox[{"g", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
       RowBox[{"b1", " ", 
        RowBox[{"(", 
         RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"x3", "[", "t", "]"}], "+", 
       RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}], " ", 
     RowBox[{"x2", "[", "t", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7707458327797623`*^9, 3.7707478413619194`*^9, 3.776778544166217*^9, {
   3.776779822425095*^9, 3.776779847928321*^9}, 3.7784386976602993`*^9, 
   3.794493536352682*^9, 3.7944935833403287`*^9, 3.7944944255061965`*^9, 
   3.7944944603249817`*^9, 3.794494585558941*^9, {3.794495088021624*^9, 
   3.79449512224515*^9}, 3.794496130183152*^9, 3.797691698029606*^9, 
   3.7976921001707864`*^9, 3.7976922871652813`*^9, 3.7976923183871965`*^9, 
   3.797692531989577*^9, 3.797698348301017*^9, 3.797698398095936*^9, 
   3.7976987459153166`*^9, 3.797698943949026*^9, 3.79769902534289*^9, 
   3.797699126270723*^9, 3.7976991938375845`*^9, 3.7976992447225046`*^9, 
   3.797699283266475*^9, 3.797699339837352*^9, 3.797699428598211*^9, 
   3.797699620315095*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "Nvect", "]"}]], "Input",
 CellChangeTimes->{{3.7668500685384293`*^9, 3.766850128622355*^9}, {
   3.7668501669474573`*^9, 3.7668501891299787`*^9}, {3.766925222079686*^9, 
   3.7669252297190833`*^9}, 3.766925513805091*^9, 3.766933727203929*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]},
     {
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"a", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
             RowBox[{"b1", " ", 
              RowBox[{"(", 
               RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "g", " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.766929614982893*^9, {3.7669296697136307`*^9, 3.7669296830397396`*^9}, 
   3.7669340206956215`*^9, 3.7669343605193305`*^9, 3.7686545732654533`*^9, 
   3.769363885982718*^9, 3.7707430908540583`*^9, 3.7707431652247505`*^9, 
   3.7707432269728365`*^9, 3.7707458330734425`*^9, 3.7707478413980503`*^9, 
   3.7767785441842318`*^9, {3.776779822441053*^9, 3.7767798479462376`*^9}, 
   3.778438697714155*^9, 3.794493536406679*^9, 3.794493583360297*^9, 
   3.7944944255502253`*^9, 3.794494460382951*^9, 3.794494585615941*^9, {
   3.7944950880506244`*^9, 3.794495122259144*^9}, 3.794496130197152*^9, 
   3.797691698073635*^9, 3.79769210018781*^9, 3.7976922871872573`*^9, 
   3.797692318411233*^9, 3.7976925320356064`*^9, 3.7976983483570213`*^9, 
   3.7976983981159344`*^9, 3.797698745942313*^9, 3.7976989439690247`*^9, 
   3.7976990253618574`*^9, 3.7976991262897224`*^9, 3.7976991938565845`*^9, 
   3.797699244742533*^9, 3.7976992832864456`*^9, 3.7976993398573523`*^9, 
   3.7976994286172085`*^9, 3.797699620334094*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Center of Mass", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.7668506621499777`*^9, 3.7668506628399115`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mtotal", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", "*", "Ms"}], "+", "Mh"}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COM", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"gstS", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}], 
       "+", " ", 
       RowBox[{
        RowBox[{"gstH", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Mh"}], 
       "+", 
       RowBox[{
        RowBox[{"gstS2", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}]}], 
      ")"}], "/", "Mtotal"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"COM", ",", "t"}], "]"}]}], ";"}], "//", 
  "FullSimplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"dCOM", " ", ",", "t"}], "]"}]}], ";"}], " ", "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7668486252840843`*^9, 3.7668486490930033`*^9}, {
   3.766848680163347*^9, 3.7668487722907896`*^9}, {3.7668489204997654`*^9, 
   3.766848972164424*^9}, {3.766849327582846*^9, 3.766849486239126*^9}, {
   3.766849539920843*^9, 3.7668496591355314`*^9}, {3.766849691133127*^9, 
   3.766849794955684*^9}, {3.766849838815553*^9, 3.7668498753572845`*^9}, 
   3.7668502773152695`*^9, {3.766850657609066*^9, 3.7668506580725536`*^9}, 
   3.7668520771706724`*^9, {3.76685459667849*^9, 3.766854599331273*^9}, {
   3.7707431955567904`*^9, 3.770743212243*^9}, {3.7873305584405737`*^9, 
   3.787330581641489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "COM", "]"}]], "Input",
 CellChangeTimes->{{3.766925486674221*^9, 3.7669254907527857`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a", "+", "b1"}], ")"}], " ", "Mh"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"a", "+", 
                RowBox[{"2", " ", "b1"}]}], ")"}], " ", "Ms"}]}], ")"}]}], 
          " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mh", "+", 
            RowBox[{"2", " ", "Ms"}]}], ")"}], " ", 
          RowBox[{"x1", "[", "t", "]"}]}]}], 
        RowBox[{"Mh", "+", 
         RowBox[{"2", " ", "Ms"}]}]]},
      {
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", "b1"}], ")"}], " ", "Mh"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", 
               RowBox[{"2", " ", "b1"}]}], ")"}], " ", "Ms"}]}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Mh", "+", 
            RowBox[{"2", " ", "Ms"}]}], ")"}], " ", 
          RowBox[{"x2", "[", "t", "]"}]}]}], 
        RowBox[{"Mh", "+", 
         RowBox[{"2", " ", "Ms"}]}]]},
      {"0"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7669296212926598`*^9, 3.7669333658812623`*^9, 3.7669340242895927`*^9, 
   3.7686545779130244`*^9, 3.7693638900884304`*^9, 3.77074322765434*^9, 
   3.770747841958009*^9, 3.776778544890416*^9, {3.776779823208523*^9, 
   3.776779848431959*^9}, 3.7784386982268467`*^9, 3.7944935368596735`*^9, 
   3.7944935838113203`*^9, 3.7944944259991956`*^9, 3.79449446082998*^9, 
   3.7944945860649347`*^9, {3.794495097702074*^9, 3.7944951227791433`*^9}, 
   3.7944961307091446`*^9, 3.797691698837603*^9, 3.7976921007737837`*^9, 
   3.7976922874032593`*^9, 3.7976923192131925`*^9, 3.797698349417985*^9, 
   3.7976983992109013`*^9, 3.7976987471329484`*^9, 3.7976989450829945`*^9, 
   3.7976990264298544`*^9, 3.79769912736972*^9, 3.797699194944583*^9, 
   3.7976992458375015`*^9, 3.7976992843764725`*^9, 3.7976993409523516`*^9, 
   3.7976994297622538`*^9, 3.797699621426092*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.766850517290866*^9, 3.7668505243431225`*^9}, {
   3.7668507239896917`*^9, 3.7668507266940975`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"pF2", " ", "=", " ", 
   RowBox[{"gpF2", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pF1", " ", "=", " ", 
   RowBox[{"gpF", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fx", " ", "=", " ", 
   RowBox[{
    RowBox[{"pF2", "[", 
     RowBox[{"[", "1", "]"}], "]"}], "-", 
    RowBox[{"pF1", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fy", " ", "=", " ", 
   RowBox[{
    RowBox[{"pF2", "[", 
     RowBox[{"[", "2", "]"}], "]"}], "-", 
    RowBox[{"pF1", "[", 
     RowBox[{"[", "2", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"SSupp", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", 
     RowBox[{"x", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"Swap", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pF2", " ", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"pF2", "[", 
       RowBox[{"[", "2", "]"}], "]"}], "}"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"VHC", " ", "=", 
    RowBox[{"{", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"fx", "^", "2"}], " ", "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"fy", "/", "2"}], ")"}], "^", "2"}], " ", "-", " ", 
       RowBox[{"2", "*", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}]}]}], "}"}], "}"}]}], "]"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"VHC", " ", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"fx", "^", "2"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"fy", "/", "2"}], ")"}], "^", "2"}], " ", "-", " ", 
        RowBox[{"2", "*", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b"}], ")"}]}]}], "}"}], "}"}]}], "]"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"ASSupp", " ", "=", " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"SSupp", ",", 
        RowBox[{"{", 
         RowBox[{"Transpose", "[", "x", "]"}], "}"}]}], "]"}], ",", "2"}], 
     "]"}], "//", "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"ASwap", "=", " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"Swap", ",", 
        RowBox[{"{", 
         RowBox[{"Transpose", "[", "x", "]"}], "}"}]}], "]"}], ",", "2"}], 
     "]"}], "//", "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"AVHC", " ", "=", " ", 
    RowBox[{
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"VHC", ",", 
         RowBox[{"{", 
          RowBox[{"Transpose", "[", "x", "]"}], "}"}]}], "]"}], ",", "2"}], 
      "]"}], "//", "FullSimplify"}]}], "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"AdotSSupp", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"ASSupp", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"AdotSwap", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"ASwap", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"AdotVHC", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"AVHC", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7707428567809563`*^9, 3.7707428786444855`*^9}, {
   3.7707431547749386`*^9, 3.7707431553366747`*^9}, {3.794493248234437*^9, 
   3.7944934714114647`*^9}, 3.7944935642076607`*^9, {3.7944936622370567`*^9, 
   3.794493662731064*^9}, {3.794493700755503*^9, 3.794493705240535*^9}, {
   3.7944938517615385`*^9, 3.794493932586363*^9}, {3.7944941294800186`*^9, 
   3.794494131638995*^9}, {3.794494234131569*^9, 3.7944942723637514`*^9}, {
   3.7944944114344435`*^9, 3.7944944387290974`*^9}, {3.794494535245163*^9, 
   3.7944945421211195`*^9}, {3.7944951114495316`*^9, 3.79449511356249*^9}, {
   3.7945678216084623`*^9, 3.7945678313174276`*^9}, {3.794568008371915*^9, 
   3.7945680085739155`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"x1", "[", "t", "]"}]},
     {
      RowBox[{"x2", "[", "t", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996214460926`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], "-", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"x1", "[", "t", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}], "-", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}]}], "+", 
       RowBox[{"x2", "[", "t", "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996214530935`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b"}], ")"}]}], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}], "-", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sin", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}], "-", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}], "2"]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.797699621459092*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0"},
     {"0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996214640923`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], "-", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]},
     {"0", "1", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996215070925`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", 
         FractionBox[
          RowBox[{"x4", "[", "t", "]"}], "2"], "]"}], "2"], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"x3", "[", "t", "]"}]}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"x3", "[", "t", "]"}]}], "+", 
            FractionBox[
             RowBox[{"3", " ", 
              RowBox[{"x4", "[", "t", "]"}]}], "2"]}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"x4", "[", "t", "]"}], "2"], "]"}]}], "+", 
         RowBox[{"5", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.797699621703092*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996217080927`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Sin", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SuperscriptBox["x3", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}], "+", 
            RowBox[{
             SuperscriptBox["x4", "\[Prime]",
              MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996218580914`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
       RowBox[{"Sin", "[", 
        FractionBox[
         RowBox[{"x4", "[", "t", "]"}], "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"x3", "[", "t", "]"}]}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{"Sin", "[", 
           FractionBox[
            RowBox[{"x4", "[", "t", "]"}], "2"], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"x3", "[", "t", "]"}]}], "+", 
            FractionBox[
             RowBox[{"3", " ", 
              RowBox[{"x4", "[", "t", "]"}]}], "2"]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], ")"}]}], "]"}], "-", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"2", " ", 
               RowBox[{"x3", "[", "t", "]"}]}], "+", 
              RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x4", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"6", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"x3", "[", "t", "]"}], "+", 
                 RowBox[{"x4", "[", "t", "]"}]}], ")"}]}], "]"}]}], "-", 
            RowBox[{"3", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"x3", "[", "t", "]"}]}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.770743091128619*^9, 3.770743165275384*^9, 3.7707432277034597`*^9, 
   3.7707478420006413`*^9, 3.7767785449382567`*^9, {3.7767798232633753`*^9, 
   3.776779848482833*^9}, 3.778438698280707*^9, 3.7944935369206758`*^9, 
   3.7944935838283195`*^9, {3.7944944260152216`*^9, 3.7944944608499527`*^9}, 
   3.7944945506252346`*^9, 3.7944945860829096`*^9, {3.7944950977170486`*^9, 
   3.7944951227951183`*^9}, 3.794496130722144*^9, 3.7976916988806*^9, 
   3.7976921008057795`*^9, 3.7976922874222546`*^9, 3.7976923192361627`*^9, 
   3.797698349458014*^9, 3.7976983992299013`*^9, 3.7976987471539483`*^9, 
   3.797698945099993*^9, 3.797699026452855*^9, 3.797699127388691*^9, 
   3.797699194967628*^9, 3.7976992458565035`*^9, 3.79769928439644*^9, 
   3.7976993409733496`*^9, 3.797699429797209*^9, 3.7976996225100913`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Partitioned Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 3.5431473723201914`*^9, {3.797691082022411*^9, 
   3.797691084487399*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xO", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3", "[", "t", "]"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TO", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "Mh", "}"}], ",", 
     RowBox[{"{", "Ms1", "}"}], ",", 
     RowBox[{"{", "Isz1", "}"}], ",", 
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b1", "}"}], ",", 
     RowBox[{"{", "g", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"T", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", "Mh", "}"}], ",", 
     RowBox[{"{", "Ms1", "}"}], ",", 
     RowBox[{"{", "Ms2", "}"}], ",", 
     RowBox[{"{", "Isz1", "}"}], ",", " ", 
     RowBox[{"{", "Isz2", "}"}], ",", 
     RowBox[{"{", "a", "}"}], ",", 
     RowBox[{"{", "b1", "}"}], ",", 
     RowBox[{"{", "b2", "}"}], ",", 
     RowBox[{"{", "g", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xC", " ", "=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{"x", ",", "xO"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TC", " ", "=", " ", 
   RowBox[{"Complement", "[", 
    RowBox[{"T", ",", "T"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"BadSyms", " ", "=", " ", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Union", "[", 
    RowBox[{"xC", ",", "TC"}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nvect", " ", "=", " ", 
   RowBox[{"Expand", "[", "Nvect", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Npart", " ", "=", " ", "Nvect"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", " ", "=", " ", "1"}], ",", " ", 
   RowBox[{"i", "<=", 
    RowBox[{"Length", "[", "Nvect", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", "\t", 
   RowBox[{
    RowBox[{"terms", "=", 
     RowBox[{"Level", "[", 
      RowBox[{
       RowBox[{"Nvect", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", "1"}], "]"}]}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"Npart", "[", 
      RowBox[{"[", 
       RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "=", " ", "0"}], ";", 
    "\[IndentingNewLine]", "\t", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", " ", "=", " ", "1"}], ",", " ", 
      RowBox[{"j", "\[LessEqual]", 
       RowBox[{"Length", "[", "terms", "]"}]}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
      RowBox[{
       RowBox[{"exp", " ", "=", 
        RowBox[{"terms", "[", 
         RowBox[{"[", "j", "]"}], "]"}]}], ";", "\[IndentingNewLine]", "\t\t", 
       RowBox[{"vars", " ", "=", " ", 
        RowBox[{"Variables", "@", 
         RowBox[{"Level", "[", 
          RowBox[{"exp", ",", 
           RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
       "\t\t", 
       RowBox[{
        RowBox[{"Npart", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], " ", "]"}], " ", "=", " ", 
        RowBox[{
         RowBox[{"Npart", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], " ", "]"}], " ", "+", " ", 
         RowBox[{"If", "[", " ", 
          RowBox[{
           RowBox[{"IntersectingQ", "[", 
            RowBox[{"BadSyms", ",", "vars"}], " ", "]"}], ",", "0", ",", 
           "exp"}], "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "\t", 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.797691321991666*^9, 3.797691344887638*^9}, {
   3.7976913786665363`*^9, 3.797691381511496*^9}, {3.797691725995568*^9, 
   3.7976917938153596`*^9}, {3.7976919451442394`*^9, 
   3.7976919901501184`*^9}, {3.797692088678822*^9, 3.797692091208826*^9}, {
   3.79769219426353*^9, 3.7976921999115343`*^9}, {3.7976922408544016`*^9, 
   3.797692241157424*^9}, {3.7976923373031626`*^9, 3.7976923436231394`*^9}, {
   3.797692379241042*^9, 3.797692379557046*^9}, {3.7976924830957475`*^9, 
   3.7976924979406753`*^9}, {3.7976926238453417`*^9, 3.797692845606769*^9}, {
   3.797692877909685*^9, 3.797692880771652*^9}, {3.7976929568044777`*^9, 
   3.797693037187214*^9}, {3.797693215892768*^9, 3.797693243651725*^9}, {
   3.797693425652226*^9, 3.7976934258972507`*^9}, {3.797693461646123*^9, 
   3.7976935504168997`*^9}, {3.797693593428794*^9, 3.7976937813613453`*^9}, {
   3.797693813416292*^9, 3.797693881186138*^9}, {3.797693916419013*^9, 
   3.7976940276247826`*^9}, {3.797694159422464*^9, 3.797694174481426*^9}, {
   3.797694212920311*^9, 3.7976943788346596`*^9}, {3.7976944422825084`*^9, 
   3.7976944540964403`*^9}, {3.797694523557315*^9, 3.7976945284973154`*^9}, {
   3.7976945696542125`*^9, 3.797694678062933*^9}, {3.797694716677883*^9, 
   3.79769474067282*^9}, 3.797694783141731*^9, {3.7976948442445917`*^9, 
   3.7976948475845833`*^9}, {3.7976948916414843`*^9, 3.7976949260303717`*^9}, 
   3.7976949565413017`*^9, {3.7976950953430223`*^9, 3.797695099818016*^9}, {
   3.7976951406258907`*^9, 3.797695160191885*^9}, {3.7976952270107145`*^9, 
   3.7976953250574965`*^9}, {3.797695355998417*^9, 3.7976953823033705`*^9}, {
   3.797695736019477*^9, 3.797695810460308*^9}, {3.7976969238209996`*^9, 
   3.7976969311470003`*^9}, {3.7976971140156975`*^9, 
   3.7976971559786067`*^9}, {3.797698169225295*^9, 3.7976982976920943`*^9}, {
   3.797698373139946*^9, 3.7976983765799446`*^9}, 3.7976985703146133`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"x4", "[", "t", "]"}], "}"}]], "Output",
 CellChangeTimes->{3.7976984003528996`*^9, 3.797698748274329*^9, 
  3.7976989462379913`*^9, 3.797699027554854*^9, 3.797699128502689*^9, 
  3.7976991960825825`*^9, 3.7976992469805346`*^9, 3.7976992855204387`*^9, 
  3.7976993421053486`*^9, 3.7976994309502068`*^9, 3.7976996225640917`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", "Nvect", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", "Npart", "]"}], "]"}]}], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"-", "g"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", 
             RowBox[{"(", 
              RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
            RowBox[{"b1", " ", 
             RowBox[{"(", 
              RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "g", " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.797698400565898*^9, 3.797698748488331*^9, 
  3.797698946446991*^9, 3.797699027763853*^9, 3.7976991287126923`*^9, 
  3.7976991962875814`*^9, 3.7976992471885*^9, 3.7976992857274413`*^9, 
  3.7976993423253508`*^9, 3.7976994311622047`*^9, 3.797699622769094*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {
      RowBox[{"g", " ", 
       RowBox[{"(", 
        RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]},
     {
      RowBox[{
       RowBox[{"-", "g"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}]},
     {"0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.797698400565898*^9, 3.797698748488331*^9, 
  3.797698946446991*^9, 3.797699027763853*^9, 3.7976991287126923`*^9, 
  3.7976991962875814`*^9, 3.7976992471885*^9, 3.7976992857274413`*^9, 
  3.7976993423253508`*^9, 3.7976994311622047`*^9, 3.79769962278712*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mpart", " ", "=", " ", "Mmatrix"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"terms", "=", 
       RowBox[{"Level", "[", 
        RowBox[{
         RowBox[{"Expand", "[", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{"Mmatrix", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], "]"}], "]"}], ",", "1"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Mpart", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "=", " ", "0"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"k", " ", "=", " ", "1"}], ",", " ", 
        RowBox[{"k", "\[LessEqual]", 
         RowBox[{"Length", "[", "terms", "]"}]}], ",", 
        RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", "\t\t", 
        RowBox[{
         RowBox[{"exp", " ", "=", 
          RowBox[{"terms", "[", 
           RowBox[{"[", "k", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{"vars", " ", "=", " ", 
          RowBox[{"Variables", "@", 
           RowBox[{"Level", "[", 
            RowBox[{"exp", ",", 
             RowBox[{"-", "1"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\t\t", 
         RowBox[{
          RowBox[{"Mpart", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], " ", "]"}], " ", "=", " ", 
          RowBox[{
           RowBox[{"Mpart", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], " ", "]"}], " ", "+", " ", 
           RowBox[{"If", "[", " ", 
            RowBox[{
             RowBox[{"IntersectingQ", "[", 
              RowBox[{"BadSyms", ",", "vars"}], "]"}], ",", "0", ",", "exp"}],
             "]"}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.797691321991666*^9, 3.797691344887638*^9}, {
   3.7976913786665363`*^9, 3.797691381511496*^9}, {3.797691725995568*^9, 
   3.7976917938153596`*^9}, {3.7976919451442394`*^9, 
   3.7976919901501184`*^9}, {3.797692088678822*^9, 3.797692091208826*^9}, {
   3.79769219426353*^9, 3.7976921999115343`*^9}, {3.7976922408544016`*^9, 
   3.797692241157424*^9}, {3.7976923373031626`*^9, 3.7976923436231394`*^9}, {
   3.797692379241042*^9, 3.797692379557046*^9}, {3.7976924830957475`*^9, 
   3.7976924979406753`*^9}, {3.7976926238453417`*^9, 3.797692845606769*^9}, {
   3.797692877909685*^9, 3.797692880771652*^9}, {3.7976929568044777`*^9, 
   3.797693037187214*^9}, {3.797693215892768*^9, 3.797693243651725*^9}, {
   3.797693425652226*^9, 3.7976934258972507`*^9}, {3.797693461646123*^9, 
   3.7976935504168997`*^9}, {3.797693593428794*^9, 3.7976937813613453`*^9}, {
   3.797693813416292*^9, 3.797693881186138*^9}, {3.797693916419013*^9, 
   3.7976940276247826`*^9}, {3.797694159422464*^9, 3.797694174481426*^9}, {
   3.797694212920311*^9, 3.7976943788346596`*^9}, {3.7976944422825084`*^9, 
   3.7976944540964403`*^9}, {3.797694523557315*^9, 3.7976945284973154`*^9}, {
   3.7976945696542125`*^9, 3.797694678062933*^9}, {3.797694716677883*^9, 
   3.79769474067282*^9}, 3.797694783141731*^9, {3.7976948442445917`*^9, 
   3.7976948475845833`*^9}, {3.7976948916414843`*^9, 3.7976949260303717`*^9}, 
   3.7976949565413017`*^9, {3.7976950953430223`*^9, 3.797695099818016*^9}, {
   3.7976951406258907`*^9, 3.797695160191885*^9}, {3.7976952270107145`*^9, 
   3.7976953250574965`*^9}, {3.797695355998417*^9, 3.7976953823033705`*^9}, {
   3.797695736019477*^9, 3.797695810460308*^9}, {3.7976969238209996`*^9, 
   3.7976969311470003`*^9}, {3.7976971140156975`*^9, 
   3.7976971559786067`*^9}, {3.797698169225295*^9, 3.7976982976920943`*^9}, {
   3.797698373139946*^9, 3.7976983765799446`*^9}, {3.797698462665801*^9, 
   3.7976985937045794`*^9}, {3.7976986549695225`*^9, 
   3.7976987229053936`*^9}, {3.7976988838120985`*^9, 3.797698923671077*^9}, {
   3.7976989633210053`*^9, 3.7976989924709215`*^9}, {3.7976990955607996`*^9, 
   3.7976991113477592`*^9}, {3.797699172751629*^9, 3.7976991751596227`*^9}, {
   3.797699220553595*^9, 3.797699260487484*^9}, {3.797699309976454*^9, 
   3.7976993173343945`*^9}, {3.797699367032316*^9, 3.797699410647297*^9}, {
   3.7976995298150845`*^9, 3.7976995320550547`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", "Mmatrix", "]"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"FullSimplify", "[", "Mpart", "]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.797698312618058*^9, 3.797698318263045*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], "0", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]},
     {"0", 
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
           RowBox[{"b1", " ", 
            RowBox[{"(", 
             RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], 
      RowBox[{"Isz1", "+", "Isz2", "+", 
       RowBox[{
        SuperscriptBox["b1", "2"], " ", "Ms1"}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}]},
     {
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2", "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7976953879413776`*^9, {3.797695752842429*^9, 3.7976957785363364`*^9}, 
   3.797695813444274*^9, {3.797698323054062*^9, 3.7976983511619816`*^9}, 
   3.797698400997898*^9, 3.7976987486083593`*^9, 3.797699285880467*^9, 
   3.7976993427053475`*^9, 3.7976994312852345`*^9, 3.7976996228700905`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], "0"},
     {"0", 
      RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], "0"},
     {
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], 
      RowBox[{"Isz1", "+", "Isz2", "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", "Mh"}], "+", 
       RowBox[{"2", " ", "a", " ", "b1", " ", "Mh"}], "+", 
       RowBox[{
        SuperscriptBox["b1", "2"], " ", "Mh"}], "+", 
       RowBox[{
        SuperscriptBox["b1", "2"], " ", "Ms1"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"a", "+", "b1"}], ")"}], "2"]}], "-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"a", "+", "b1"}], ")"}], " ", "b2"}], "+", 
          SuperscriptBox["b2", "2"]}], ")"}], " ", "Ms2"}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}]},
     {"0", "0", 
      RowBox[{"Isz2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}], 
      RowBox[{"Isz2", "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], "2"], " ", "Ms2"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7976953879413776`*^9, {3.797695752842429*^9, 3.7976957785363364`*^9}, 
   3.797695813444274*^9, {3.797698323054062*^9, 3.7976983511619816`*^9}, 
   3.797698400997898*^9, 3.7976987486083593`*^9, 3.797699285880467*^9, 
   3.7976993427053475`*^9, 3.7976994312852345`*^9, 3.797699622954089*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cpart", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cpart", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Mpart", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], "]"}],
          "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mpart", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mpart", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ")"}], " ", 
            RowBox[{"xdot", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}]}], "]"}], "\n", 
 RowBox[{
  RowBox[{"Cpart", " ", "=", " ", 
   RowBox[{"Cpart", "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7976995529830194`*^9, 3.7976995811611643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Ms1", " ", "=", " ", "Ms"}], ";", "\[IndentingNewLine]", 
    RowBox[{"Ms2", " ", "=", " ", "Ms"}], ";", "\[IndentingNewLine]", 
    RowBox[{"b1", "  ", "=", " ", "b"}], ";", "\[IndentingNewLine]", 
    RowBox[{"b2", " ", "=", " ", "b"}], ";", "\[IndentingNewLine]", 
    RowBox[{"MatrixForm", "[", 
     RowBox[{"Nvect", " ", "=", 
      RowBox[{"FullSimplify", "[", "Nvect", "]"}]}], "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.7976915893109303`*^9, 3.7976916758647118`*^9}, 
   3.7976922816473036`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "Cmtx", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "Cpart", "]"}]}], "Input",
 CellChangeTimes->{{3.797699599300182*^9, 3.7976996027071276`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
               RowBox[{"b1", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], 
             " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "-", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1", "-", "b2"}], ")"}]}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
               RowBox[{"b1", " ", 
                RowBox[{"(", 
                 RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], 
             " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
          RowBox[{
           SuperscriptBox["x3", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
          RowBox[{
           SuperscriptBox["x4", "\[Prime]",
            MultilineFunction->None], "[", "t", "]"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x4", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"a", "+", "b1"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}], "+", 
         RowBox[{
          SuperscriptBox["x4", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{"a", "+", "b1"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{"a", "+", "b1", "-", "b2"}], ")"}], " ", "Ms2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x4", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7976996230370893`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", 
          RowBox[{"(", 
           RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
         RowBox[{"b1", " ", 
          RowBox[{"(", 
           RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms2"}], ")"}]}], "+", 
          RowBox[{"b1", " ", 
           RowBox[{"(", 
            RowBox[{"Mh", "+", "Ms1", "+", "Ms2"}], ")"}]}]}], ")"}]}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["x3", "\[Prime]",
         MultilineFunction->None], "[", "t", "]"}]}], "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7976996230450892`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export", "Section",
 CellChangeTimes->{{3.511177531124222*^9, 3.511177531860264*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", "dim"}], "=", 
    "4"}], ";", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", "1", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"x2", "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", "2", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"x3", "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", "3", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"x4", "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", "4", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "'"}], "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", 
       RowBox[{"dim", "+", "1"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x2", "'"}], "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", 
       RowBox[{"dim", "+", "2"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x3", "'"}], "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", 
       RowBox[{"dim", "+", "3"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x4", "'"}], "[", "t", "]"}], ":=", 
      RowBox[{"x", "[", 
       RowBox[{"dim", "+", "4"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "''"}], "[", "t", "]"}], ":=", 
      RowBox[{"ac", "[", "1", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x2", "''"}], "[", "t", "]"}], ":=", 
      RowBox[{"ac", "[", "2", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"x3", "''"}], "[", "t", "]"}], ":=", 
      RowBox[{"ac", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x4", "''"}], "[", "t", "]"}], ":=", 
      RowBox[{"ac", "[", "4", "]"}]}]}], "}"}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.523274663953125*^9, 3.5232746810625*^9}, {
   3.52327495384375*^9, 3.5232750456875*^9}, {3.5232901581875*^9, 
   3.523290214203125*^9}, {3.523380407609375*^9, 3.52338042590625*^9}, {
   3.523380594984375*^9, 3.523380620390625*^9}, {3.538749586056141*^9, 
   3.5387495922311406`*^9}, {3.538835825326691*^9, 3.538835847437691*^9}, {
   3.5431437314051914`*^9, 3.5431437394361916`*^9}, {3.543928827586776*^9, 
   3.5439288325927753`*^9}, {3.5550941946856728`*^9, 
   3.5550942017716727`*^9}, {3.5550942703126726`*^9, 3.555094363648673*^9}, {
   3.555178321819333*^9, 3.555178343561333*^9}, {3.5551783963133335`*^9, 
   3.5551784047093334`*^9}, {3.5553271072898808`*^9, 3.55532714308346*^9}, {
   3.5558698844658337`*^9, 3.5558698887528334`*^9}, {3.5558699258888335`*^9, 
   3.5558699260948334`*^9}, 3.7404899945838785`*^9, 3.763985685557726*^9, {
   3.766839059428672*^9, 3.7668390599897084`*^9}, 3.7668476276088934`*^9, {
   3.766855781789193*^9, 3.7668557985722*^9}, {3.7668571709820786`*^9, 
   3.766857216438575*^9}, {3.7668578392979937`*^9, 3.766857879684413*^9}, {
   3.7707429503728247`*^9, 3.7707429625817437`*^9}, {3.794496113338601*^9, 
   3.794496117611549*^9}, 3.7976920651708913`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
   "toplevelfolder", " ", "=", " ", 
    "\"\<Z:\\\\Member Folders\\\\Mark \
Yeatman\\\\Codes\\\\Matlab\\\\StandardizedSimCode\\\\Derivations\\\\\
ToMatlabOutputs\\\\\>\""}], ";", "\[IndentingNewLine]", 
   RowBox[{"configfolder", " ", "=", " ", "\"\<2LinkCompassGait\\\\\>\""}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.772280051875898*^9, 3.7722800532501335`*^9}, 3.7724712823764505`*^9, {
   3.772544319812922*^9, 3.7725443260688457`*^9}, {3.7778180168305063`*^9, 
   3.777818063490815*^9}, {3.7778183190733128`*^9, 3.7778183490397363`*^9}, {
   3.7778185165591946`*^9, 3.7778185469889517`*^9}, {3.777901679193923*^9, 
   3.7779017110013313`*^9}, {3.777902180651893*^9, 3.7779021807915163`*^9}, {
   3.777902374229483*^9, 3.7779023749006786`*^9}, {3.7779186193079967`*^9, 
   3.77791861948753*^9}, {3.7784385696715817`*^9, 3.778438572871893*^9}, 
   3.7794519595319333`*^9, {3.794495847719986*^9, 3.7944958500439587`*^9}, 
   3.7976920609308968`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", "kinematics", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"folder", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "toplevelfolder", ",", "configfolder", ",", 
      "\"\<KinematicFunctions\\\\\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
        RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
        RowBox[{"(*", 
         RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", 
        "Null", " ", 
        RowBox[{"(*", 
         RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
        RowBox[{
        "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}],
        " ", 
       RowBox[{"(*", 
        RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"gpF", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<Foot_st_pos.m\>\""}], "]"}], ",", 
      "posFst"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"gpH", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<Hip_pos.m\>\""}], "]"}], ",", "posH"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"gpF2", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<Foot_sw_pos.m\>\""}], "]"}], ",", 
      "posFsw"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"COM", ",", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<COM_pos.m\>\""}], "]"}], ",", "posCoM"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"ddCOM", ",", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<COM_accel.m\>\""}], "]"}], ",", "ddCoM"}], 
     "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.7707429696217318`*^9, 3.7707429721658187`*^9}, {3.7707430607135105`*^9, 
   3.77074306250099*^9}, 3.7767785143536353`*^9, {3.7784385849045095`*^9, 
   3.778438602851256*^9}, {3.794496266390394*^9, 3.7944962667624073`*^9}, 
   3.797692052262961*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", "energies", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"folder", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "toplevelfolder", ",", "configfolder", ",", 
      "\"\<EnergyFunctions\\\\\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
        RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
        RowBox[{"(*", 
         RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", 
        "Null", " ", 
        RowBox[{"(*", 
         RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
        RowBox[{
        "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}],
        " ", 
       RowBox[{"(*", 
        RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"KE", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<Kinetic_energy.m\>\""}], "]"}], ",", 
      "Ke"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"PE", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<Potential_energy.m\>\""}], "]"}], ",", 
      "Pe"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.7668475432072716`*^9, 3.7668475477684174`*^9}, 
   3.7668504338042464`*^9, {3.7668530695298395`*^9, 3.7668530798987293`*^9}, {
   3.7668533594830723`*^9, 3.766853367639927*^9}, {3.766854483188921*^9, 
   3.766854505253061*^9}, 3.7668545789148684`*^9, 3.766854995282686*^9, 
   3.7686547531060104`*^9, {3.769432665825548*^9, 3.7694326790870624`*^9}, {
   3.7707430175249577`*^9, 3.770743017813447*^9}, 3.770743070677532*^9, 
   3.776778517204945*^9, 3.7784386449043055`*^9, 3.797692048405945*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"dynamics", " ", "matrices"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"folder", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "toplevelfolder", ",", "configfolder", ",", 
      "\"\<DynamicsFunctions\\\\\>\""}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
        RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
        RowBox[{"(*", 
         RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", 
        "Null", " ", 
        RowBox[{"(*", 
         RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
        RowBox[{
        "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}],
        " ", 
       RowBox[{"(*", 
        RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"Mmatrix", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<M_matrix.m\>\""}], "]"}], ",", "M"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"Cmtx", ",", " ", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<C_matrix.m\>\""}], "]"}], ",", "Cmat"}], 
     "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"Nvect", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<G_matrix.m\>\""}], "]"}], ",", "G"}], 
     "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.766847369204723*^9, 3.7668473878355303`*^9}, {
   3.766847585864328*^9, 3.7668476038959827`*^9}, {3.766850014475005*^9, 
   3.766850030554435*^9}, {3.7668513704203095`*^9, 3.7668514120052505`*^9}, {
   3.766852039183888*^9, 3.7668520503689537`*^9}, {3.7668522727052794`*^9, 
   3.766852275008807*^9}, {3.766853046421412*^9, 3.766853064043687*^9}, {
   3.7668533011781917`*^9, 3.766853344089145*^9}, {3.7668545084217052`*^9, 
   3.7668545783400555`*^9}, {3.7668549993942747`*^9, 3.766855030304912*^9}, {
   3.7669298825923967`*^9, 3.766929952780774*^9}, 3.768654755038561*^9, {
   3.7694326966967845`*^9, 3.769432710767831*^9}, {3.769432884128147*^9, 
   3.769432884270279*^9}, {3.7707430212381487`*^9, 3.7707430239736624`*^9}, 
   3.770743074199259*^9, 3.7767785202049227`*^9, 3.778438652505666*^9, 
   3.7976920279409943`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"folder", " ", "=", " ", 
    RowBox[{"StringJoin", "[", 
     RowBox[{
     "toplevelfolder", ",", "configfolder", ",", 
      "\"\<ConstraintFunctions\\\\\>\""}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
      RowBox[{"Switch", "[", 
       RowBox[{
        RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
        RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
        RowBox[{"(*", 
         RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", 
        "Null", " ", 
        RowBox[{"(*", 
         RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
        RowBox[{
        "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}],
        " ", 
       RowBox[{"(*", 
        RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"ASSupp", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<ASSupp_matrix.m\>\""}], "]"}], ",", 
      "Assupp"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"ASwap", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<ASwap_matrix.m\>\""}], "]"}], ",", 
      "Aswap"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"AVHC", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<AVHC_matrix.m\>\""}], "]"}], ",", "Avhc"}],
      "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"AdotSSupp", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<AdotSSupp_matrix.m\>\""}], "]"}], ",", 
      "Adotssupp"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"AdotSwap", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<AdotSwap_matrix.m\>\""}], "]"}], ",", 
      "Adotswap"}], "]"}], "\[IndentingNewLine]", 
    RowBox[{"WriteMatlab", "[", 
     RowBox[{"AdotVHC", ",", 
      RowBox[{"StringJoin", "[", 
       RowBox[{"folder", ",", "\"\<AdotVHC_matrix.m\>\""}], "]"}], ",", 
      "Adotvhc"}], "]"}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.766847369204723*^9, 3.7668473878355303`*^9}, {
   3.766847585864328*^9, 3.7668476038959827`*^9}, {3.766850014475005*^9, 
   3.766850030554435*^9}, {3.7668513704203095`*^9, 3.7668514120052505`*^9}, {
   3.766852039183888*^9, 3.7668520503689537`*^9}, {3.7668522727052794`*^9, 
   3.766852275008807*^9}, {3.766853046421412*^9, 3.766853064043687*^9}, {
   3.7668533011781917`*^9, 3.766853344089145*^9}, {3.7668545084217052`*^9, 
   3.7668545783400555`*^9}, {3.7668549993942747`*^9, 3.766855030304912*^9}, {
   3.7669298825923967`*^9, 3.766929952780774*^9}, {3.7669300298150535`*^9, 
   3.7669300304872227`*^9}, {3.767027925855274*^9, 3.7670279811678314`*^9}, {
   3.768654057672942*^9, 3.7686541161610613`*^9}, {3.768654266327976*^9, 
   3.768654276783001*^9}, {3.7686547566709433`*^9, 3.7686547762366705`*^9}, {
   3.770743029606077*^9, 3.770743032981947*^9}, 3.770743077396716*^9, 
   3.7767785237417755`*^9, 3.7784386636408663`*^9, 3.77843871561373*^9, {
   3.7944934828299046`*^9, 3.7944935147018824`*^9}, {3.7976920192800436`*^9, 
   3.7976920369239764`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Unset", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "[", "t", "]"}], ",", " ", 
      RowBox[{"x2", "[", "t", "]"}], ",", " ", 
      RowBox[{"x3", "[", "t", "]"}], ",", " ", 
      RowBox[{"x4", "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{"x1", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x2", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x3", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x4", "'"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x1", "''"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x2", "''"}], "[", "t", "]"}], ",", " ", 
      RowBox[{
       RowBox[{"x3", "''"}], "[", "t", "]"}], ",", 
      RowBox[{
       RowBox[{"x4", "''"}], "[", "t", "]"}]}], "}"}], "]"}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.766934307338765*^9, 3.7669344074321623`*^9}, {
   3.7707430364037156`*^9, 3.7707430442139316`*^9}, 3.797692068996873*^9}]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{1912, Automatic}, {Automatic, -6}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 245, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[837, 29, 1634, 40, 170, "Input"],
Cell[2474, 71, 708, 13, 19, "Message"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3219, 89, 2749, 49, 50, "Input"],
Cell[5971, 140, 1763, 38, 90, "Output"],
Cell[7737, 180, 2041, 46, 90, "Output"]
}, Open  ]],
Cell[9793, 229, 4495, 102, 210, "Input"],
Cell[14291, 333, 4473, 96, 190, "Input"],
Cell[18767, 431, 2996, 72, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21800, 508, 213, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[22038, 515, 221, 3, 35, "Subsubsection"],
Cell[22262, 520, 2664, 70, 70, "Input"],
Cell[CellGroupData[{
Cell[24951, 594, 1032, 23, 50, "Input"],
Cell[25986, 619, 7121, 192, 92, "Output"],
Cell[33110, 813, 7886, 205, 101, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41045, 1024, 216, 3, 35, "Subsubsection"],
Cell[41264, 1029, 3003, 78, 110, "Input"],
Cell[CellGroupData[{
Cell[44292, 1111, 348, 5, 29, "Input"],
Cell[44643, 1118, 6891, 179, 108, "Output"]
}, Open  ]],
Cell[51549, 1300, 1371, 28, 70, "Input"],
Cell[52923, 1330, 760, 20, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53720, 1355, 175, 2, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[53920, 1361, 1205, 31, 50, "Input"],
Cell[55128, 1394, 1570, 37, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56735, 1436, 285, 4, 29, "Input"],
Cell[57023, 1442, 2770, 67, 88, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[59842, 1515, 326, 4, 35, "Subsubsection"],
Cell[60171, 1521, 1873, 52, 90, "Input"],
Cell[CellGroupData[{
Cell[62069, 1577, 133, 2, 29, "Input"],
Cell[62205, 1581, 3506, 91, 93, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[65760, 1678, 375, 5, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[66160, 1687, 4698, 135, 350, "Input"],
Cell[70861, 1824, 1473, 31, 56, "Output"],
Cell[72337, 1857, 2297, 56, 56, "Output"],
Cell[74637, 1915, 2460, 60, 48, "Output"],
Cell[77100, 1977, 1437, 29, 54, "Output"],
Cell[78540, 2008, 2651, 67, 56, "Output"],
Cell[81194, 2077, 2575, 63, 49, "Output"],
Cell[83772, 2142, 1437, 29, 52, "Output"],
Cell[85212, 2173, 4249, 111, 56, "Output"],
Cell[89464, 2286, 4251, 107, 49, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[93776, 2400, 275, 4, 61, "Section"],
Cell[CellGroupData[{
Cell[94076, 2408, 5556, 128, 370, "Input"],
Cell[99635, 2538, 366, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100038, 2549, 215, 4, 50, "Input"],
Cell[100256, 2555, 1995, 55, 88, "Output"],
Cell[102254, 2612, 1368, 38, 86, "Output"]
}, Open  ]],
Cell[103637, 2653, 4818, 95, 250, "Input"],
Cell[CellGroupData[{
Cell[108480, 2752, 283, 5, 50, "Input"],
Cell[108766, 2759, 6490, 183, 92, "Output"],
Cell[115259, 2944, 3792, 108, 92, "Output"]
}, Open  ]],
Cell[119066, 3055, 2607, 72, 110, "Input"],
Cell[121676, 3129, 604, 13, 130, "Input"],
Cell[CellGroupData[{
Cell[122305, 3146, 204, 3, 50, "Input"],
Cell[122512, 3151, 6004, 166, 108, "Output"],
Cell[128519, 3319, 1682, 49, 86, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130250, 3374, 91, 1, 61, "Section"],
Cell[130344, 3377, 3033, 73, 70, "Input"],
Cell[133380, 3452, 1974, 31, 50, "Input"],
Cell[135357, 3485, 3112, 66, 170, "Input"],
Cell[138472, 3553, 1977, 44, 110, "Input"],
Cell[140452, 3599, 2544, 55, 130, "Input"],
Cell[142999, 3656, 3378, 72, 170, "Input"],
Cell[146380, 3730, 1029, 28, 29, "Input"]
}, Open  ]]
}
]
*)

