(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    141973,       3581]
NotebookOptionsPosition[    137938,       3452]
NotebookOutlinePosition[    138476,       3472]
CellTagsIndexPosition[    138433,       3469]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Modeling by Mark Yeatman
mxy110230@utdallas.edu
Sept 2019\
\>", "Subsubtitle",
 CellChangeTimes->{{3.5111737331439896`*^9, 3.511173737039212*^9}, {
  3.520768651078125*^9, 3.520768659875*^9}, {3.521818801734375*^9, 
  3.521818813484375*^9}, {3.543075080431307*^9, 3.5430750818223066`*^9}, {
  3.555090980418681*^9, 3.5550909814106812`*^9}, {3.5870545444315977`*^9, 
  3.5870545499091454`*^9}, {3.763919879566497*^9, 3.7639199143025894`*^9}, {
  3.7779151244623256`*^9, 3.7779151349803295`*^9}}],

Cell[CellGroupData[{

Cell["Initialization", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}, {
   3.7685736312280703`*^9, 3.768573641896326*^9}, {3.7778182597402086`*^9, 
   3.777818268541385*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "spell"}], ",", 
    RowBox[{"General", "::", "spell1"}], ",", 
    StyleBox[
     RowBox[{"Get", "::", "noopen"}], "MessageName"], 
    StyleBox[",", "MessageName"], 
    StyleBox[
     RowBox[{"Needs", "::", "nocont"}], "MessageName"]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<Screws`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<Screws`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<RobotLinks`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindFile", "[", "\"\<ToMatlab`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$Assumptions", "=", 
   RowBox[{"_", "\[Element]", "Reals"}]}], ";"}]}], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Open Chain Kinematics (COP Reference Frame)", "Section",
 CellChangeTimes->{{3.587054562815436*^9, 3.5870545683829927`*^9}, 
   3.7639210008236065`*^9, {3.763922322016376*^9, 3.763922332416171*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"x", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x4", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x5", "[", "t", "]"}], "}"}]}], "}"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{",", 
      RowBox[{"{", 
       RowBox[{"x6", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x7", "[", "t", "]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x8", "[", "t", "]"}], "}"}]}], "}"}], ";"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"CoPx", ",", " ", "CoPy", ",", " ", 
    RowBox[{"hip", " ", "angle"}], ",", " ", 
    RowBox[{"knee", " ", "angle"}], ",", " ", 
    RowBox[{"ankle", " ", "angle"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xdot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"x", ",", "t"}], "]"}]}], ";", " ", 
  RowBox[{"xddot", " ", "=", " ", 
   RowBox[{"D", "[", 
    RowBox[{"xdot", ",", "t"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{
  3.5111737472017937`*^9, {3.511173782073788*^9, 3.5111737868600616`*^9}, {
   3.5111755940464272`*^9, 3.511175600408791*^9}, {3.520686131703125*^9, 
   3.520686135875*^9}, {3.520686309671875*^9, 3.520686312484375*^9}, {
   3.520687115453125*^9, 3.5206871275625*^9}, {3.52078867884375*^9, 
   3.52078872540625*^9}, {3.520857852828125*^9, 3.520857856765625*^9}, {
   3.521820034578125*^9, 3.52182003665625*^9}, {3.521820194515625*^9, 
   3.52182019925*^9}, {3.521911060609375*^9, 3.52191106496875*^9}, 
   3.5219945113125*^9, {3.523028145328125*^9, 3.523028147203125*^9}, 
   3.523028568734375*^9, {3.523033556203125*^9, 3.5230335580625*^9}, {
   3.52303366240625*^9, 3.523033664046875*^9}, {3.5232996586875*^9, 
   3.523299669890625*^9}, 3.523299712796875*^9, {3.52330022171875*^9, 
   3.523300234421875*^9}, {3.52330028559375*^9, 3.52330029028125*^9}, 
   3.5233008249375*^9, {3.523360415484375*^9, 3.523360421828125*^9}, {
   3.523380309234375*^9, 3.52338031990625*^9}, {3.523380358796875*^9, 
   3.523380364234375*^9}, {3.5287165611401763`*^9, 3.5287165746088295`*^9}, {
   3.543073868103307*^9, 3.543073894812307*^9}, 3.5430739902623067`*^9, {
   3.5430742662443066`*^9, 3.543074273445307*^9}, 3.5430744729683065`*^9, {
   3.5430748729733067`*^9, 3.5430748749423065`*^9}, {3.555095285078673*^9, 
   3.5550952976686726`*^9}, {3.5553255793781047`*^9, 3.555325590112178*^9}, 
   3.5559492285885787`*^9, {3.587054558588013*^9, 3.587054560969251*^9}, {
   3.7639210046785345`*^9, 3.763921006646368*^9}, {3.7639223376326623`*^9, 
   3.7639223408171253`*^9}, {3.7639888827120976`*^9, 3.763988883260669*^9}, {
   3.7639889168895807`*^9, 3.7639889213377137`*^9}, {3.779450916264507*^9, 
   3.7794509496944666`*^9}, 3.779454858414114*^9, {3.7888939847217913`*^9, 
   3.7888939851688175`*^9}, {3.789135603001992*^9, 3.789135603770023*^9}, {
   3.7894053444576626`*^9, 3.7894053552674913`*^9}, {3.7894054043724403`*^9, 
   3.789405412657139*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x3", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x4", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x5", "[", "t", "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.788894758176518*^9, 3.7888948346245923`*^9, 3.7888949137880135`*^9, 
   3.7888951701123247`*^9, 3.7888954071779733`*^9, 3.7891324372348046`*^9, 
   3.7891331168841276`*^9, 3.789135611719898*^9, 3.7891430468548746`*^9, 
   3.7893197052529306`*^9, 3.7894058331469293`*^9, 3.7894059033647385`*^9, 
   3.78940600567448*^9, 3.7894062092643223`*^9, {3.789406284048826*^9, 
   3.7894063065907364`*^9}, 3.7894064617455397`*^9, 3.7894891261157618`*^9, 
   3.789489279835597*^9, 3.7894893794656496`*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ax1", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ax2", " ", "=", " ", 
   RowBox[{"PrismaticTwist", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax3", " ", "=", " ", 
    RowBox[{"RevoluteTwist", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"hip", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax4", " ", "=", " ", 
    RowBox[{"RevoluteTwist", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "lt"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"knee", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ax5", " ", "=", " ", 
    RowBox[{"RevoluteTwist", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{
         RowBox[{"-", "lt"}], "-", "ls"}], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"ankle", " ", "axis"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"axzero", " ", "=", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}]}],
    ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e1", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax1", ",", 
      RowBox[{"x1", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e2", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax2", ",", 
      RowBox[{"x2", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e3", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax3", ",", 
      RowBox[{"x3", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e4", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax4", ",", 
      RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"e5", " ", "=", " ", 
    RowBox[{"TwistExp", "[", 
     RowBox[{"ax5", ",", 
      RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.520686144890625*^9, 3.520686145203125*^9}, {
   3.52068617653125*^9, 3.520686205625*^9}, {3.520686284921875*^9, 
   3.520686305984375*^9}, {3.520686374484375*^9, 3.520686441609375*^9}, {
   3.52068650903125*^9, 3.520686509140625*^9}, {3.52068656871875*^9, 
   3.520686617546875*^9}, {3.5206873421875*^9, 3.520687418140625*^9}, {
   3.5207688911875*^9, 3.520768891421875*^9}, {3.5208577891875*^9, 
   3.5208577938125*^9}, {3.52182001190625*^9, 3.521820023734375*^9}, {
   3.521911082890625*^9, 3.52191115175*^9}, {3.52191125971875*^9, 
   3.521911294796875*^9}, {3.521911335375*^9, 3.5219113548125*^9}, {
   3.5219119563125*^9, 3.521911956390625*^9}, {3.521994532609375*^9, 
   3.521994535875*^9}, {3.52206939596875*^9, 3.5220694045625*^9}, {
   3.523028084703125*^9, 3.523028115890625*^9}, 3.523028291140625*^9, 
   3.523033323140625*^9, 3.523033450765625*^9, {3.52303353259375*^9, 
   3.5230335539375*^9}, {3.5230373085*^9, 3.52303737340625*^9}, {
   3.523037467328125*^9, 3.52303746903125*^9}, 3.52330047*^9, {
   3.523358999328125*^9, 3.52335906684375*^9}, {3.523360273125*^9, 
   3.523360357953125*^9}, {3.5233608009375*^9, 3.523360804421875*^9}, {
   3.52336423246875*^9, 3.52336423984375*^9}, 3.528716608959394*^9, {
   3.5378114879773455`*^9, 3.5378114882175856`*^9}, {3.539014808319905*^9, 
   3.5390148139360275`*^9}, {3.543073943307307*^9, 3.543074019945307*^9}, {
   3.5430740586903067`*^9, 3.543074064726307*^9}, {3.543075246569307*^9, 
   3.5430752470013065`*^9}, {3.5431422985871916`*^9, 3.543142308314192*^9}, {
   3.5439277592067757`*^9, 3.5439277644517756`*^9}, {3.5439278106917753`*^9, 
   3.5439278108357754`*^9}, {3.5551529968463793`*^9, 3.555153041439379*^9}, {
   3.5553255954747143`*^9, 3.555325607990966*^9}, {3.555949225987579*^9, 
   3.5559492261145787`*^9}, 3.763920382649495*^9, {3.7779154880375853`*^9, 
   3.777915489791995*^9}, {3.7779155558626766`*^9, 3.777915584522359*^9}, {
   3.7779156312055073`*^9, 3.777915668341381*^9}, {3.7794509614240685`*^9, 
   3.7794509643940334`*^9}, {3.7888939477448034`*^9, 
   3.7888939976487913`*^9}, {3.788894043904642*^9, 3.7888940441286693`*^9}, {
   3.78913556673139*^9, 3.789135569212396*^9}, {3.789405366657712*^9, 
   3.7894054011573143`*^9}, {3.7894055794367576`*^9, 3.789405601826569*^9}, {
   3.789489275106629*^9, 3.7894892752786713`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Reference", " ", "Configuration"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Position", " ", "Configuration", " ", "of", " ", "Centers", " ", "of", 
    " ", "Mass"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"gst00", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "/", "2"}], ",", "0"}], "}"}]}], "]"}]}], 
    ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"thigh", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gst01", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", 
          RowBox[{"ls", "/", "2"}]}], ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "  ", 
   RowBox[{"(*", 
    RowBox[{"shank", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gst02", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"lf", "/", "4"}], ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "ls", "-", 
          RowBox[{"la", "/", "2"}]}], ",", "0"}], "}"}]}], "]"}]}], ";"}], 
   "  ", 
   RowBox[{"(*", 
    RowBox[{"foot", " ", "CoM", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Position", " ", "Configuration", " ", "of", " ", "Joints"}], 
    "*)"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "With", " ", "Inertial", " ", "Reference", " ", "Frame", " ", "Origin", 
     " ", "at", " ", "Pyramid", " ", "Adapter"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp0", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"-", "lt"}], ",", "0"}], "}"}]}], "]"}]}], ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"knee", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp1", " ", "=", " ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "ls"}], ",", "0"}], "}"}]}], "]"}]}], 
    ";"}], "  ", 
   RowBox[{"(*", 
    RowBox[{"ankle", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp2", " ", "=", "  ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "ls", "-", "la"}], ",", "0"}], "}"}]}], 
      "]"}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{"heel", " ", "pos"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"gp3", " ", "=", "  ", 
     RowBox[{"RPToHomogeneous", "[", 
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"lf", ",", 
         RowBox[{
          RowBox[{"-", "lt"}], "-", "ls", "-", "la"}], ",", "0"}], "}"}]}], 
      "]"}]}], " ", ";"}], 
   RowBox[{"(*", 
    RowBox[{"toe", " ", "pos"}], "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.52068675271875*^9, 3.5206868401875*^9}, {
   3.52068688309375*^9, 3.520686884765625*^9}, {3.5206869316875*^9, 
   3.52068695546875*^9}, {3.52068703525*^9, 3.5206870995*^9}, {
   3.52068721059375*^9, 3.5206872309375*^9}, {3.520687329875*^9, 
   3.520687335984375*^9}, {3.520687447921875*^9, 3.520687482640625*^9}, {
   3.52085775021875*^9, 3.5208577569375*^9}, {3.52182002690625*^9, 
   3.521820029890625*^9}, {3.52199454090625*^9, 3.5219945435625*^9}, {
   3.521994576609375*^9, 3.521994577125*^9}, 3.522069407859375*^9, {
   3.52302817175*^9, 3.52302817784375*^9}, {3.52302821046875*^9, 
   3.523028219296875*^9}, {3.52302827453125*^9, 3.523028289421875*^9}, {
   3.52303357528125*^9, 3.523033624796875*^9}, {3.5232999903125*^9, 
   3.523300034796875*^9}, {3.52330072346875*^9, 3.52330075775*^9}, {
   3.5387617592355986`*^9, 3.538761759396615*^9}, {3.5387617916248374`*^9, 
   3.5387617925049257`*^9}, {3.543074082165307*^9, 3.543074148335307*^9}, {
   3.543074210203307*^9, 3.5430743652183065`*^9}, {3.543074567731307*^9, 
   3.543074573234307*^9}, {3.5551530722213793`*^9, 3.555153123128379*^9}, {
   3.5551548714599023`*^9, 3.555154880689748*^9}, {3.7638166935451756`*^9, 
   3.76381674183117*^9}, {3.7639203529556055`*^9, 3.7639203532584653`*^9}, 
   3.777915741587598*^9, {3.777915829761903*^9, 3.7779159177626963`*^9}, {
   3.7779159515282807`*^9, 3.777916003113441*^9}, {3.7779160400165005`*^9, 
   3.777916110144987*^9}, {3.7779161407274213`*^9, 3.777916143287918*^9}, {
   3.7779195888114386`*^9, 3.7779197056350513`*^9}, {3.777919750640922*^9, 
   3.777919834642557*^9}, {3.777919896262021*^9, 3.777920009221264*^9}, {
   3.77824242292951*^9, 3.778242429459546*^9}, {3.779450970274663*^9, 
   3.7794509909440484`*^9}, {3.779451074414469*^9, 3.779451076344076*^9}, {
   3.7888940070407314`*^9, 3.7888941084974794`*^9}, {3.7891318513629436`*^9, 
   3.7891319048504467`*^9}, {3.7891319924343557`*^9, 3.789131992929347*^9}, {
   3.7891355718843565`*^9, 3.7891355933561063`*^9}, {3.789143014577739*^9, 
   3.7891430312648053`*^9}, {3.789405436562293*^9, 3.789405450867075*^9}, {
   3.7894054862071376`*^9, 3.7894054908069744`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Positions", " ", "of", " ", 
    RowBox[{"COM", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expThigh", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "gst00"}], " ", "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expShank", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gst01"}], " ", "//",
        "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MatrixForm", "[", 
    RowBox[{"expFoot", " ", "=", " ", 
     RowBox[{
      RowBox[{
      "e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", "gst02"}], "//", 
      "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Positions", " ", "of", " ", 
     RowBox[{"Joints", "'"}], "s"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expKnee", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "gp0"}], " ", "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expAnkle", " ", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "gp1"}], "//", 
       "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expHeel", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", "gp2"}],
        "//", "FullSimplify"}]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"expToe", "=", " ", 
      RowBox[{
       RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", "gp3"}],
        "//", "FullSimplify"}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.777916229424477*^9, 3.777916270381218*^9}, {
   3.7779163127880306`*^9, 3.777916347846925*^9}, {3.777917702260448*^9, 
   3.7779177166249943`*^9}, {3.777920031602582*^9, 3.777920129651227*^9}, {
   3.778242379154322*^9, 3.778242436913762*^9}, {3.779450995034585*^9, 
   3.779450995504221*^9}, 3.7794510822041583`*^9, 3.779451494973237*^9, {
   3.779451715032281*^9, 3.7794517162701*^9}, {3.7888939101777906`*^9, 
   3.7888939120167975`*^9}, {3.788894113681466*^9, 3.7888941458884444`*^9}, {
   3.7891319195541277`*^9, 3.789132000289261*^9}, 3.7891321509286947`*^9, {
   3.7894055146373243`*^9, 3.7894055296045446`*^9}, {3.789405610756324*^9, 
   3.789405613856591*^9}, 3.7894892584637537`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"x3", "[", "t", "]"}], "+", 
        RowBox[{"x4", "[", "t", "]"}], "+", 
        RowBox[{"x5", "[", "t", "]"}]}], "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}], "+", 
         RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", "lf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{
        FractionBox["1", "2"], " ", "la", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"x1", "[", "t", "]"}]}]},
     {
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x3", "[", "t", "]"}], "+", 
        RowBox[{"x4", "[", "t", "]"}], "+", 
        RowBox[{"x5", "[", "t", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{
        RowBox[{"x3", "[", "t", "]"}], "+", 
        RowBox[{"x4", "[", "t", "]"}], "+", 
        RowBox[{"x5", "[", "t", "]"}]}], "]"}], "0", 
      RowBox[{
       RowBox[{
        FractionBox["1", "4"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "4"}], " ", "lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
          RowBox[{"4", " ", "ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"2", " ", "la", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"lf", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{"x2", "[", "t", "]"}]}]},
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7894892618477*^9, 3.789489280167594*^9}, 
   3.7894893800376425`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Positions", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
    RowBox[{"Twist", " ", "Coordinates"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"twKnee", " ", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expKnee", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"twAnkle", " ", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expAnkle", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"twHeel", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expHeel", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"twToe", " ", "=", " ", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"HomogeneousToTwist", "[", "expToe", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "1"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7779204525493727`*^9, 3.777920501484518*^9}, {
   3.777923446877672*^9, 3.7779235163681517`*^9}, {3.777923572661972*^9, 
   3.7779236477617826`*^9}, {3.7782424648648305`*^9, 
   3.7782424700181203`*^9}, {3.7794511037436476`*^9, 3.7794511069439173`*^9}, 
   3.788893925153881*^9, {3.788894152320421*^9, 3.7888942140487027`*^9}, {
   3.789132047744733*^9, 3.7891320774085145`*^9}, {3.789132146510707*^9, 
   3.7891321546566567`*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893806586547`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.789489380785659*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.789489380917657*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893810446587`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893811696606`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893812966633`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "notTwistMatrix"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"-- Message text not found -- \
(\[NoBreak]\\!\\(\\*RowBox[{\\\"\\\\\\\"HomogeneousToTwist\\\\\\\"\\\"}]\\)\
\[NoBreak])\"\>"}]], "Message", "MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.7894893814266653`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Screws", "::", "wrongDimension"}], "MessageName"], 
  RowBox[{":", " "}], "\<\"-- Message text not found --\"\>"}]], "Message", \
"MSG",
 CellChangeTimes->{
  3.789132438928788*^9, 3.789133118267143*^9, 3.7891356129748807`*^9, 
   3.7891430476038885`*^9, 3.7893197060526004`*^9, 3.789405834235197*^9, 
   3.789405905216855*^9, 3.789406006584433*^9, 3.7894062102143006`*^9, {
   3.7894062850768185`*^9, 3.7894063075647044`*^9}, 3.7894064629685335`*^9, 
   3.7894891272327533`*^9, 3.789489280344593*^9, 3.789489381554667*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Velocities", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
    RowBox[{"Homogenous", " ", "Coordinates"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vKnee", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twKnee", " ", ",", "t"}], "]"}], "//", "FullSimplify"}]}], 
     "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vAnkle", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twAnkle", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vHeel", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twHeel", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"MatrixForm", "[", 
     RowBox[{"vToe", "=", " ", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"twToe", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7891321669615183`*^9, 3.789132194671665*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Joint", " ", "Jacobians"}], ",", " ", 
    RowBox[{
    "to", " ", "get", " ", "xyz", " ", "velocities", " ", "in", " ", 
     "worldframe"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Js0", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"twKnee", " ", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Js1", " ", "=", 
     RowBox[{
      RowBox[{"ArrayReshape", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"twAnkle", "  ", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"6", ",", "6"}], "}"}]}], "]"}], "//", "FullSimplify"}]}], 
    ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.777923706659791*^9, 3.7779237565195713`*^9}, 
   3.7794511114839897`*^9, {3.788894223923712*^9, 3.7888942306085463`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"J0", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", " ", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", " ", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", "gst00"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J1", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", " ", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"axzero", " ", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", "gst01"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"J2", " ", "=", 
   RowBox[{
    RowBox[{"BodyJacobian", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ax1", ",", 
        RowBox[{"x1", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax2", ",", 
        RowBox[{"x2", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax3", ",", 
        RowBox[{"x3", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax4", " ", ",", 
        RowBox[{"x4", "[", "t", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"ax5", " ", ",", 
        RowBox[{"x5", "[", "t", "]"}]}], "}"}], ",", "gst02"}], "]"}], "//", 
    "FullSimplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.5111738617903476`*^9, 3.5111738667576323`*^9}, {
   3.520687517765625*^9, 3.520687540921875*^9}, {3.520687606828125*^9, 
   3.5206876815*^9}, {3.520687776859375*^9, 3.520687825828125*^9}, {
   3.5207672543125*^9, 3.52076725465625*^9}, {3.520857785640625*^9, 
   3.520857819140625*^9}, {3.521820049171875*^9, 3.5218200495*^9}, {
   3.521820085109375*^9, 3.521820108265625*^9}, {3.52191142990625*^9, 
   3.521911483640625*^9}, {3.52199456603125*^9, 3.52199457315625*^9}, {
   3.52302830015625*^9, 3.523028386578125*^9}, {3.523300027125*^9, 
   3.523300057609375*^9}, {3.5430744013273067`*^9, 3.543074418830307*^9}, {
   3.543074460187307*^9, 3.543074460955307*^9}, {3.543074502201307*^9, 
   3.543074505464307*^9}, {3.543074580212307*^9, 3.5430745997753067`*^9}, {
   3.555153147493379*^9, 3.5551532493003793`*^9}, {3.5551548940954285`*^9, 
   3.5551548980572205`*^9}, {3.5553256191800847`*^9, 3.555325646525819*^9}, {
   3.7366939243363523`*^9, 3.7366939259987993`*^9}, 3.7404900754748125`*^9, 
   3.763816558600665*^9, {3.7779163883742123`*^9, 3.7779164686741476`*^9}, {
   3.7794511604943323`*^9, 3.779451176903656*^9}, {3.788894234592539*^9, 
   3.7888942407844353`*^9}, {3.789405645351391*^9, 3.789405670976184*^9}, {
   3.7894891195698013`*^9, 3.7894891196838126`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"Velocities", " ", "of", " ", "Joint", " ", "Points"}], ",", " ", 
   RowBox[{"Homogenous", " ", "Coordinates"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.777916507458903*^9, 3.777916525073671*^9}, {
  3.7779166027515197`*^9, 3.777916603423485*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Dynamics", "Section",
 CellChangeTimes->{{3.521995144125*^9, 3.521995144875*^9}, {
   3.526060014172608*^9, 3.5260600152917194`*^9}, {3.543078143146307*^9, 
   3.543078144569307*^9}, 3.5431473723201914`*^9}],

Cell[CellGroupData[{

Cell["Mass Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.7638166458802586`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"genM0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Mt", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Mt", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Mt", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM1", " ", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"Ms", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "Ms", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Ms", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"genM2", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", " ", 
      RowBox[{"Mf", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "Mf", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "Mf", ",", "0", ",", "0", ",", "0"}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, {
  3.7779165478146257`*^9, 3.7779165675155616`*^9}, {3.777916658006153*^9, 
  3.777916678197755*^9}, {3.7779167259496555`*^9, 3.777916846732939*^9}, {
  3.7779168813903055`*^9, 3.7779168959133525`*^9}, {3.7794511813139153`*^9, 
  3.7794511820739923`*^9}, {3.788894247827385*^9, 3.788894263857342*^9}, {
  3.7888943587372084`*^9, 3.788894362752185*^9}, {3.7894056926912575`*^9, 
  3.789405717865909*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatrixForm", "[", 
   RowBox[{"Mmatrix", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", "J0", "]"}], ".", "genM0", ".", "J0"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J1", "]"}], ".", "genM1", ".", "J1"}], "+", 
     RowBox[{
      RowBox[{"Transpose", "[", "J2", "]"}], ".", "genM2", ".", "J2"}]}]}], 
   "]"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.7638166156113358`*^9, 3.763816620939521*^9}, 
   3.7779167291694345`*^9, {3.7794511882636256`*^9, 3.7794511885040607`*^9}, {
   3.7888943680321574`*^9, 3.7888943683531675`*^9}, {3.789406297135756*^9, 
   3.7894063033907537`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Mf", "+", "Ms", "+", "Mt"}], "0", 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "lt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "la", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"lf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "la", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"lf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "la", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"lf", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]},
     {"0", 
      RowBox[{"Mf", "+", "Ms", "+", "Mt"}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", "Mf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"ls", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"la", " ", "Mf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", "Mf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "la", " ", "Mf", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "la", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "lt", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "la", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"lf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", "Mf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lt", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                RowBox[{"(", 
                 RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"ls", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"la", " ", "Mf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["lt", "2"], " ", "Mt"}], "4"], "+", 
       RowBox[{
        FractionBox["1", "4"], " ", "Ms", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ls", "+", 
           RowBox[{"2", " ", "lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{"Mf", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           FractionBox["la", "2"], "+", 
           RowBox[{"ls", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
           RowBox[{"lt", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{
              RowBox[{"x4", "[", "t", "]"}], "+", 
              RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox["lt", "2"], " ", "Ms", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          RowBox[{"x4", "[", "t", "]"}], "]"}], "2"]}], "+", 
       RowBox[{
        FractionBox["1", "16"], " ", "Mf", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"lf", "-", 
           RowBox[{"4", " ", "ls", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
           RowBox[{"4", " ", "lt", " ", 
            RowBox[{"Sin", "[", 
             RowBox[{
              RowBox[{"x4", "[", "t", "]"}], "+", 
              RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "ls", " ", "Ms", " ", 
          RowBox[{"(", 
           RowBox[{"ls", "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"4", " ", "Mf", " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"4", " ", "lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "la", " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"lf", " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"4", " ", "lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "la", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"lf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", "Mf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "ls", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "la", " ", "Mf", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "ls", " ", "Ms", " ", 
          RowBox[{"(", 
           RowBox[{"ls", "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x4", "[", "t", "]"}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"4", " ", "Mf", " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"Mf", " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"4", " ", "lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["ls", "2"], " ", "Ms"}], "+", 
         RowBox[{"4", " ", "Mf", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"la", "+", 
             RowBox[{"2", " ", "ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}], "+", 
         RowBox[{"Mf", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"lf", "-", 
             RowBox[{"4", " ", "ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}], "2"]}]}], 
        ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["la", "2"]}], "+", 
         SuperscriptBox["lf", "2"], "+", 
         RowBox[{"8", " ", "la", " ", "ls", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"4", " ", "lf", " ", "ls", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}]},
     {
      RowBox[{
       FractionBox["1", "4"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "la", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
         RowBox[{"lf", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "4"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"lf", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"2", " ", "la", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "la", " ", 
          RowBox[{"(", 
           RowBox[{"la", "+", 
            RowBox[{"2", " ", "ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"2", " ", "lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
         RowBox[{"lf", " ", 
          RowBox[{"(", 
           RowBox[{"lf", "-", 
            RowBox[{"4", " ", "ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
            RowBox[{"4", " ", "lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", "Mf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["la", "2"]}], "+", 
         SuperscriptBox["lf", "2"], "+", 
         RowBox[{"8", " ", "la", " ", "ls", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}], "-", 
         RowBox[{"4", " ", "lf", " ", "ls", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "16"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          SuperscriptBox["la", "2"]}], "+", 
         SuperscriptBox["lf", "2"]}], ")"}], " ", "Mf"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.777925135164068*^9, 3.779451640062377*^9, 3.7794517286657467`*^9, 
   3.7794518193921795`*^9, 3.7794521221852098`*^9, 3.779454878663997*^9, 
   3.779454923675926*^9, 3.7794549624470215`*^9, 3.7794550322207394`*^9, 
   3.7794558724164114`*^9, 3.7794560390929327`*^9, 3.788894762740507*^9, 
   3.7888948390695477`*^9, 3.7888949181989737`*^9, 3.788895174483285*^9, 
   3.7888954118596582`*^9, 3.7891324440657635`*^9, 3.7891331225410647`*^9, 
   3.78913561714287*^9, 3.789143050494916*^9, 3.789319708361747*^9, 
   3.789405837185083*^9, 3.7894059080470247`*^9, 3.7894060093046217`*^9, 
   3.7894062129704695`*^9, {3.789406287857804*^9, 3.7894063122806787`*^9}, 
   3.789406467204536*^9, 3.7894891355947075`*^9, 3.7894892833845773`*^9, 
   3.789489390293119*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"KE", " ", "=", " ", 
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{
     RowBox[{"Transpose", "[", "xdot", "]"}], ".", "Mmatrix", ".", 
     "xdot"}]}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.7779878725408573`*^9, 3.777987907863311*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["C Matrix", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"First", "[", 
  RowBox[{"Dimensions", "[", "x", "]"}], "]"}]], "Input"],

Cell[BoxData["5"], "Output",
 CellChangeTimes->{
  3.7794549237259455`*^9, 3.779454962485878*^9, 3.7794550322856693`*^9, 
   3.77945587250333*^9, 3.7794560391332216`*^9, 3.7888947628464766`*^9, 
   3.7888948391755466`*^9, 3.788894918282978*^9, 3.788895174586315*^9, 
   3.788895411976635*^9, 3.789132444174729*^9, 3.789133122654064*^9, 
   3.789135617225836*^9, 3.789143050568923*^9, 3.789319708452943*^9, 
   3.7894058372101994`*^9, 3.789405908074725*^9, 3.78940600932471*^9, 
   3.789406212993864*^9, {3.7894062878798037`*^9, 3.789406312338678*^9}, 
   3.789406467329505*^9, 3.7894891356977096`*^9, 3.7894892835485773`*^9, 
   3.789489390394121*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Cmtx", "=", 
   RowBox[{"0", "*", 
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"First", "[", 
      RowBox[{"Dimensions", "[", "x", "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"First", "[", 
     RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"For", "[", 
    RowBox[{
     RowBox[{"j", "=", "1"}], ",", 
     RowBox[{"j", "\[LessEqual]", 
      RowBox[{"First", "[", 
       RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], ",", 
     RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Cmtx", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "j"}], "]"}], "]"}], "=", 
      RowBox[{
       RowBox[{"1", "/", "2"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FullSimplify", "[", 
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Mmatrix", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "t"}], "]"}], "]"}],
          "+", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], "-", 
              RowBox[{"FullSimplify", "[", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Mmatrix", "[", 
                  RowBox[{"[", 
                   RowBox[{"j", ",", "k"}], "]"}], "]"}], ",", 
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}], 
             ")"}], " ", 
            RowBox[{"xdot", "[", 
             RowBox[{"[", 
              RowBox[{"k", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"First", "[", 
              RowBox[{"Dimensions", "[", "x", "]"}], "]"}]}], "}"}]}], 
          "]"}]}], ")"}]}]}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.520791335*^9, 3.520791401109375*^9}, {
  3.520791435046875*^9, 3.52079155540625*^9}, {3.520791602453125*^9, 
  3.520791651296875*^9}, {3.5207916853125*^9, 3.520791710046875*^9}, {
  3.520857930671875*^9, 3.520857946375*^9}, {3.521820137609375*^9, 
  3.52182014315625*^9}, {3.52189796709375*^9, 3.521898017515625*^9}, {
  3.523028605546875*^9, 3.52302860590625*^9}, {3.523380346921875*^9, 
  3.52338035309375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cmtx", " ", "=", " ", 
   RowBox[{"Cmtx", "//", "Simplify"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5207916539375*^9, 3.52079166959375*^9}, {
   3.520857961375*^9, 3.520857962796875*^9}, 3.740490029073041*^9, 
   3.7794549537462645`*^9, 3.779455032645787*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Center of Mass", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.7668506621499777`*^9, 3.7668506628399115`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Mtotal", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{"Ms", "+", "Mf"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"COM", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"expFoot", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Mf"}], 
       "+", 
       RowBox[{
        RowBox[{"expShank", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "*", "Ms"}]}], 
      ")"}], "/", "Mtotal"}], "//", "FullSimplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ddCOM", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"COM", ",", "t"}], "]"}], ",", "t"}], "]"}]}], ";"}], " ", "//",
   "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.7668486252840843`*^9, 3.7668486490930033`*^9}, {
   3.766848680163347*^9, 3.7668487722907896`*^9}, {3.7668489204997654`*^9, 
   3.766848972164424*^9}, {3.766849327582846*^9, 3.766849486239126*^9}, {
   3.766849539920843*^9, 3.7668496591355314`*^9}, {3.766849691133127*^9, 
   3.766849794955684*^9}, {3.766849838815553*^9, 3.7668498753572845`*^9}, 
   3.7668502773152695`*^9, {3.766850657609066*^9, 3.7668506580725536`*^9}, 
   3.7668520771706724`*^9, {3.76685459667849*^9, 3.766854599331273*^9}, 
   3.7779017633905935`*^9, {3.777907845530485*^9, 3.7779078628370676`*^9}, {
   3.777908852388829*^9, 3.777908866271268*^9}, 3.7779089377113104`*^9, {
   3.777917034759614*^9, 3.777917152641156*^9}, {3.7779178760288005`*^9, 
   3.7779178798068*^9}, {3.7794515446123724`*^9, 3.7794515655932045`*^9}, {
   3.788894376176169*^9, 3.7888944049120646`*^9}, {3.789132232346242*^9, 
   3.789132242051746*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Gravity", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"PE", " ", "=", 
   RowBox[{
    RowBox[{"g", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"expFoot", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Mf"}], "+", 
       RowBox[{
        RowBox[{"expShank", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Ms"}], "+", 
       RowBox[{
        RowBox[{"expThigh", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Mt"}]}], ")"}]}], "//",
     "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Nvect", " ", "=", " ", 
  RowBox[{
   RowBox[{"Transpose", "[", 
    RowBox[{"{", 
     RowBox[{"D", "[", 
      RowBox[{"PE", ",", 
       RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}], "//", 
   "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.436353983078125*^9, 3.436353991234375*^9}, {
   3.436354181125*^9, 3.43635418390625*^9}, 3.5090404416343727`*^9, {
   3.509539414111295*^9, 3.509539527743894*^9}, 3.509539567648764*^9, {
   3.5095401253128805`*^9, 3.5095401303828897`*^9}, {3.5095401706491876`*^9, 
   3.5095401776848*^9}, {3.520767514421875*^9, 3.520767516734375*^9}, {
   3.520767582609375*^9, 3.520767645375*^9}, {3.5207676989375*^9, 
   3.520767715578125*^9}, {3.5230288115*^9, 3.52302884490625*^9}, {
   3.5431472111331916`*^9, 3.5431472276271915`*^9}, {3.5551550672540536`*^9, 
   3.5551550847125444`*^9}, {3.7354013090469794`*^9, 3.7354013272384634`*^9}, 
   3.735402586068088*^9, {3.7355700991070976`*^9, 3.735570100188266*^9}, 
   3.7366221128014383`*^9, {3.7366221436572127`*^9, 3.736622156672744*^9}, {
   3.736694910091427*^9, 3.736694926553073*^9}, {3.7366949728562174`*^9, 
   3.7366949909853835`*^9}, {3.7366951181023893`*^9, 3.736695130005561*^9}, {
   3.740489951746674*^9, 3.7404899555238447`*^9}, 3.74050757733245*^9, {
   3.740998914667108*^9, 3.740998917544409*^9}, {3.740999028057352*^9, 
   3.74099905490458*^9}, {3.7409994625500927`*^9, 3.740999476116825*^9}, {
   3.763816821368079*^9, 3.763816827176324*^9}, {3.7639205215778227`*^9, 
   3.763920532347257*^9}, 3.7639209083266277`*^9, 3.7779166796306763`*^9, 
   3.777916742155121*^9, 3.7779176376733427`*^9, {3.7779177285125875`*^9, 
   3.7779178476035852`*^9}, {3.777917914277705*^9, 3.7779179330661697`*^9}, {
   3.7779179800614843`*^9, 3.7779179983762894`*^9}, 3.7794516778126163`*^9, {
   3.77945180036242*^9, 3.7794518014721785`*^9}, {3.7888944203840327`*^9, 
   3.788894420736061*^9}, {3.78913223235925*^9, 3.789132242063746*^9}, {
   3.7894057360660276`*^9, 3.7894057465460215`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"g", " ", 
     RowBox[{"(", 
      RowBox[{"Mf", "+", "Ms", "+", "Mt"}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"lf", " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"lt", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{"Mf", "+", "Ms"}], ")"}]}], "+", "Mt"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"ls", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"la", " ", "Mf", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}]}], ")"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], " ", "g", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"lf", " ", "Mf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "ls", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Mf"}], "+", "Ms"}], ")"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "la", " ", "Mf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], " ", "g", " ", "Mf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"lf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"2", " ", "la", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.779451683282484*^9, 3.779451744026821*^9, 
  3.779451832725129*^9, 3.7794521369373393`*^9, 3.7794548923139486`*^9, 
  3.7794549371520424`*^9, 3.779454975246415*^9, 3.7794550460155144`*^9, 
  3.7794558857633057`*^9, 3.779456051646635*^9, 3.7888947700579147`*^9, 
  3.7888948462025585`*^9, 3.7888949255079546`*^9, 3.788895181782296*^9, 
  3.788895419158617*^9, 3.7891324523806696`*^9, 3.789133130635973*^9, 
  3.789135624139043*^9, 3.7891430540289087`*^9, 3.78931971099518*^9, 
  3.7894059118847833`*^9, 3.789406013334484*^9, 3.7894062170754604`*^9, 
  3.789406291769814*^9, 3.7894063233256207`*^9, 3.789406477008486*^9, 
  3.789489154553608*^9, 3.7894892866145873`*^9, 3.789489409822437*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"g", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"expFoot", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "4"}], "]"}], "]"}], "*", "Mf"}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.789137226331215*^9, 3.789137230716157*^9}, {
  3.78913726972679*^9, 3.7891372721437674`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"g", " ", "Mf", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "lt", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"4", " ", "ls", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", "la", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"lf", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}]}], "+", 
     RowBox[{"x2", "[", "t", "]"}]}], ")"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7891372380311337`*^9, 3.7891372762137547`*^9, 
  3.7891430540469084`*^9, 3.789319711013678*^9, 3.789405911924865*^9, 
  3.789406013369561*^9, 3.789406217115462*^9, 3.789406291816799*^9, 
  3.7894063233586216`*^9, 3.7894064770564537`*^9, 3.7894891546116114`*^9, 
  3.7894892866765566`*^9, 3.789489409866459*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["DSLIP Embedding", "Subsubsection",
 CellChangeTimes->{{3.7639204805204716`*^9, 3.763920481544552*^9}, {
  3.7639209191915884`*^9, 3.7639209220715466`*^9}, {3.7639224290917854`*^9, 
  3.763922465550254*^9}, {3.766847648630418*^9, 3.7668476514948564`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pH", " ", "=", 
  RowBox[{"RPToHomogeneous", "[", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "[", "t", "]"}], "+", "px"}], ",", 
      RowBox[{
       RowBox[{"x2", "[", "t", "]"}], "+", "py"}], ",", "0"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pToe1", " ", "=", 
  RowBox[{
   RowBox[{"e1", ".", "e2", ".", "e3", ".", "e4", ".", "e5", ".", 
    RowBox[{"RPToHomogeneous", "[", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"lf", ",", 
        RowBox[{
         RowBox[{"-", "lt"}], "-", "ls", "-", "la"}], ",", "0"}], "}"}]}], 
     "]"}]}], "//", "FullSimplify"}]}]}], "Input",
 CellChangeTimes->{{3.766845505688058*^9, 3.76684553289999*^9}, {
   3.7668455649474115`*^9, 3.7668455969328227`*^9}, {3.7668456976205077`*^9, 
   3.7668457176855545`*^9}, {3.7668458100990033`*^9, 
   3.7668459042453127`*^9}, {3.766845977154875*^9, 3.7668459781451063`*^9}, {
   3.7668460926259336`*^9, 3.7668461072798533`*^9}, {3.766846150273282*^9, 
   3.7668461957155275`*^9}, {3.7668462660170736`*^9, 
   3.7668462688002214`*^9}, {3.7668476363281727`*^9, 3.766847637430479*^9}, 
   3.7668509562465286`*^9, 3.7669255101716204`*^9, {3.766933693325363*^9, 
   3.7669336959598923`*^9}, 3.7779176157591467`*^9, 3.777917647904228*^9, {
   3.7779180828433976`*^9, 3.7779180836784663`*^9}, {3.7779181149456663`*^9, 
   3.7779181240526733`*^9}, {3.77945150433457*^9, 3.7794515108626733`*^9}, {
   3.7888944733923793`*^9, 3.7888944942580204`*^9}, {3.7888948126948204`*^9, 
   3.788894825807789*^9}, {3.7888949042241383`*^9, 3.788894905759107*^9}, {
   3.788894999153144*^9, 3.7888950356723747`*^9}, {3.788895104864175*^9, 
   3.7888951152471733`*^9}, {3.788895241135119*^9, 3.7888952527861176`*^9}, 
   3.7888953409104223`*^9, {3.7894057568656845`*^9, 3.7894058101160607`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", 
     RowBox[{"px", "+", 
      RowBox[{"x1", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", 
     RowBox[{"py", "+", 
      RowBox[{"x2", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7888954191766376`*^9, 3.789132452435636*^9, 
  3.7891331306849847`*^9, 3.7891356241570415`*^9, 3.7891430540649104`*^9, 
  3.789319711027666*^9, 3.789405911945691*^9, 3.7894060133848095`*^9, 
  3.78940621713546*^9, 3.789406291833784*^9, 3.7894063233746195`*^9, 
  3.7894064770744843`*^9, 3.789489154632606*^9, 3.7894892866925573`*^9, 
  3.7894894098824396`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"x3", "[", "t", "]"}], "+", 
       RowBox[{"x4", "[", "t", "]"}], "+", 
       RowBox[{"x5", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", 
       RowBox[{
        RowBox[{"x3", "[", "t", "]"}], "+", 
        RowBox[{"x4", "[", "t", "]"}], "+", 
        RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], ",", "0", ",", 
     RowBox[{
      RowBox[{"lf", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}], "+", 
         RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"lt", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
      RowBox[{"ls", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"la", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}], "+", 
         RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"x1", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{
       RowBox[{"x3", "[", "t", "]"}], "+", 
       RowBox[{"x4", "[", "t", "]"}], "+", 
       RowBox[{"x5", "[", "t", "]"}]}], "]"}], ",", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"x3", "[", "t", "]"}], "+", 
       RowBox[{"x4", "[", "t", "]"}], "+", 
       RowBox[{"x5", "[", "t", "]"}]}], "]"}], ",", "0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "lt"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"x3", "[", "t", "]"}], "]"}]}], "-", 
      RowBox[{"ls", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
      RowBox[{"la", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}], "+", 
         RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"lf", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         RowBox[{"x3", "[", "t", "]"}], "+", 
         RowBox[{"x4", "[", "t", "]"}], "+", 
         RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
      RowBox[{"x2", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7888954191766376`*^9, 3.789132452435636*^9, 
  3.7891331306849847`*^9, 3.7891356241570415`*^9, 3.7891430540649104`*^9, 
  3.789319711027666*^9, 3.789405911945691*^9, 3.7894060133848095`*^9, 
  3.78940621713546*^9, 3.789406291833784*^9, 3.7894063233746195`*^9, 
  3.7894064770744843`*^9, 3.789489154632606*^9, 3.7894892866925573`*^9, 
  3.789489409942439*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", 
  RowBox[{"L1", " ", "=", " ", 
   RowBox[{
    RowBox[{"Refine", "[", 
     RowBox[{
      RowBox[{"Norm", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"pH", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "-", 
         RowBox[{"pToe1", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}]}], " ", ",", 
        "2"}], "]"}], ",", 
      RowBox[{"x", " ", "\[Element]", "Reals"}]}], "]"}], " ", "//", 
    "FullSimplify"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"L1dot", " ", "=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"L1", ",", "t"}], "]"}], "//", "FullSimplify"}]}], "]"}], "\n", 
 RowBox[{"MatrixForm", "[", 
  RowBox[{"LJacob1", "=", " ", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{"D", "[", 
       RowBox[{"L1", ",", 
        RowBox[{"Transpose", "[", "x", "]"}]}], "]"}], "}"}], "]"}], "//", 
    "FullSimplify"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.766845505688058*^9, 3.76684553289999*^9}, {
   3.7668455649474115`*^9, 3.7668455969328227`*^9}, {3.7668456976205077`*^9, 
   3.7668457176855545`*^9}, {3.7668458100990033`*^9, 
   3.7668459042453127`*^9}, {3.766845977154875*^9, 3.7668459781451063`*^9}, {
   3.7668460926259336`*^9, 3.7668461072798533`*^9}, {3.766846150273282*^9, 
   3.7668461957155275`*^9}, {3.7668462660170736`*^9, 
   3.7668462688002214`*^9}, {3.7668476363281727`*^9, 3.766847637430479*^9}, 
   3.7668509562465286`*^9, 3.7669255101716204`*^9, {3.766933693325363*^9, 
   3.7669336959598923`*^9}, 3.7779176157591467`*^9, 3.777917647904228*^9, {
   3.7779180828433976`*^9, 3.7779180836784663`*^9}, {3.7779181149456663`*^9, 
   3.7779181240526733`*^9}, {3.77945150433457*^9, 3.7794515108626733`*^9}, {
   3.7888944733923793`*^9, 3.7888944942580204`*^9}, {3.7888948126948204`*^9, 
   3.788894825807789*^9}, {3.7888949042241383`*^9, 3.788894905759107*^9}, {
   3.788894999153144*^9, 3.7888950356723747`*^9}, {3.788895104864175*^9, 
   3.7888951152471733`*^9}, {3.788895241135119*^9, 3.7888952527861176`*^9}, {
   3.788895334610432*^9, 3.7888953712973776`*^9}, {3.7893196565027037`*^9, 
   3.7893196813826714`*^9}}],

Cell[BoxData[
 TagBox[
  SqrtBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "px"}], "+", 
       RowBox[{"lf", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"la", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"py", "+", 
       RowBox[{"lt", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
       RowBox[{"ls", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
       RowBox[{"la", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
       RowBox[{"lf", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"x3", "[", "t", "]"}], "+", 
          RowBox[{"x4", "[", "t", "]"}], "+", 
          RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.788895377613352*^9, 3.788895423136629*^9, 
  3.7891324565396013`*^9, 3.7891331345479293`*^9, 3.7891356313379617`*^9, 
  3.789143060610942*^9, 3.7893197162890263`*^9, 3.789405915127815*^9, 
  3.7894060165146627`*^9, 3.7894062202504873`*^9, 3.789406295795763*^9, 
  3.7894063267586355`*^9, 3.789406480589463*^9, 3.789489158528584*^9, 
  3.7894892868135567`*^9, 3.7894894126684866`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"py", "+", 
        RowBox[{"lt", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"la", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"lf", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "lt"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "-", 
        RowBox[{"ls", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
        RowBox[{"lf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x5", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
        RowBox[{"la", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x5", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], ")"}]}], 
     "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "px"}], "+", 
        RowBox[{"lf", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"lt", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{"la", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"lt", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"x3", "[", "t", "]"}], "]"}], " ", 
         RowBox[{
          SuperscriptBox["x3", "\[Prime]",
           MultilineFunction->None], "[", "t", "]"}]}], "+", 
        RowBox[{"ls", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "+", 
        RowBox[{"la", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x5", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}], "-", 
        RowBox[{"lf", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["x3", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x4", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}], "+", 
           RowBox[{
            SuperscriptBox["x5", "\[Prime]",
             MultilineFunction->None], "[", "t", "]"}]}], ")"}]}]}], 
       ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"2", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "px"}], "+", 
          RowBox[{"lf", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"lt", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"ls", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"la", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"py", "+", 
          RowBox[{"lt", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
          RowBox[{"ls", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
          RowBox[{"la", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
          RowBox[{"lf", " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             RowBox[{"x3", "[", "t", "]"}], "+", 
             RowBox[{"x4", "[", "t", "]"}], "+", 
             RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]]}], 
    ")"}]}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.788895377613352*^9, 3.788895423136629*^9, 
  3.7891324565396013`*^9, 3.7891331345479293`*^9, 3.7891356313379617`*^9, 
  3.789143060610942*^9, 3.7893197162890263`*^9, 3.789405915127815*^9, 
  3.7894060165146627`*^9, 3.7894062202504873`*^9, 3.789406295795763*^9, 
  3.7894063267586355`*^9, 3.789406480589463*^9, 3.789489158528584*^9, 
  3.7894892868135567`*^9, 3.789489427001293*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"lt", " ", "px", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"ls", " ", "px", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"la", " ", "px", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"lf", " ", "py", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"lt", " ", "py", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"ls", " ", "py", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "lf"}], " ", "px"}], "+", 
            RowBox[{"la", " ", "py"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "px"}], "+", 
             RowBox[{"lf", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"lt", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"py", "+", 
             RowBox[{"lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"lf", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]]]}]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "ls"}], " ", "px", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"lf", " ", "lt", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"la", " ", "px"}], "+", 
           RowBox[{"lf", " ", "py"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"ls", " ", "lt", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"x4", "[", "t", "]"}], "]"}]}], "-", 
        RowBox[{"ls", " ", "py", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "-", 
        RowBox[{"la", " ", "lt", " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"lf", " ", "px"}], "-", 
           RowBox[{"la", " ", "py"}]}], ")"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{
           RowBox[{"x3", "[", "t", "]"}], "+", 
           RowBox[{"x4", "[", "t", "]"}], "+", 
           RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], 
       SqrtBox[
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "px"}], "+", 
            RowBox[{"lf", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"lt", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"ls", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"la", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"py", "+", 
            RowBox[{"lt", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
            RowBox[{"ls", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
            RowBox[{"la", " ", 
             RowBox[{"Cos", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
            RowBox[{"lf", " ", 
             RowBox[{"Sin", "[", 
              RowBox[{
               RowBox[{"x3", "[", "t", "]"}], "+", 
               RowBox[{"x4", "[", "t", "]"}], "+", 
               RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"lf", " ", "ls", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"lf", " ", "lt", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"la", " ", "px", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"lf", " ", "py", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{"la", " ", "ls", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"x5", "[", "t", "]"}], "]"}]}], "+", 
         RowBox[{"la", " ", "lt", " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "lf"}], " ", "px"}], "+", 
            RowBox[{"la", " ", "py"}]}], ")"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            RowBox[{"x3", "[", "t", "]"}], "+", 
            RowBox[{"x4", "[", "t", "]"}], "+", 
            RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "px"}], "+", 
             RowBox[{"lf", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"lt", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ls", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"py", "+", 
             RowBox[{"lt", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"x3", "[", "t", "]"}], "]"}]}], "+", 
             RowBox[{"ls", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}]}], "]"}]}], "+", 
             RowBox[{"la", " ", 
              RowBox[{"Cos", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}], "-", 
             RowBox[{"lf", " ", 
              RowBox[{"Sin", "[", 
               RowBox[{
                RowBox[{"x3", "[", "t", "]"}], "+", 
                RowBox[{"x4", "[", "t", "]"}], "+", 
                RowBox[{"x5", "[", "t", "]"}]}], "]"}]}]}], ")"}], "2"]}]]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.788895377613352*^9, 3.788895423136629*^9, 
  3.7891324565396013`*^9, 3.7891331345479293`*^9, 3.7891356313379617`*^9, 
  3.789143060610942*^9, 3.7893197162890263`*^9, 3.789405915127815*^9, 
  3.7894060165146627`*^9, 3.7894062202504873`*^9, 3.789406295795763*^9, 
  3.7894063267586355`*^9, 3.789406480589463*^9, 3.789489158528584*^9, 
  3.7894892868135567`*^9, 3.78948943662045*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraints", "Subsubsection",
 CellChangeTimes->{{3.52076884215625*^9, 3.520768850859375*^9}, 
   3.520790829140625*^9, {3.52079098478125*^9, 3.520790985625*^9}, {
   3.763816609462988*^9, 3.763816653783472*^9}, {3.7668481265350714`*^9, 
   3.7668481477981267`*^9}, {3.766850517290866*^9, 3.7668505243431225`*^9}, {
   3.7668507239896917`*^9, 3.7668507266940975`*^9}, 3.7779182583562975`*^9, 
   3.7800619533924427`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"CHip", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3", "[", "t", "]"}], "}"}]}], "}"}]}], 
  " "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AHip", " ", "=", " ", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"CHip", ",", 
        RowBox[{"{", 
         RowBox[{"Transpose", "[", "x", "]"}], "}"}]}], "]"}], ",", "2"}], 
     "]"}], "//", "FullSimplify"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"AdotHip", " ", "=", " ", 
    RowBox[{"D", "[", 
     RowBox[{"AHip", ",", "t"}], "]"}]}], ";"}], "//", 
  "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.780061738303975*^9, 3.780061842673415*^9}, {
  3.7888945341138983`*^9, 3.7888945380968957`*^9}, {3.788894855289422*^9, 
  3.788894872847986*^9}, {3.789405828315523*^9, 3.7894058304026947`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"x1", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x2", "[", "t", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"x3", "[", "t", "]"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7800619574324703`*^9, 3.7888948463165298`*^9, 
  3.788895429391609*^9, 3.7891324643005333`*^9, 3.7891331424148407`*^9, 
  3.7891356408148575`*^9, 3.789143070712985*^9, 3.789319732439391*^9, 
  3.789405925941599*^9, 3.789406026619589*^9, 3.789406230706679*^9, 
  3.78940630619374*^9, 3.7894063383825502`*^9, 3.789406493292366*^9, 
  3.789489170661519*^9, 3.789489296598527*^9, 3.789489436681451*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"MatrixForm", "[", "AHip", "]"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "AdotHip", "]"}]}], "Input",
 CellChangeTimes->{{3.7800618500637393`*^9, 3.7800618553635435`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0"},
     {"0", "0", "1", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7800619575026927`*^9, 3.788894846333558*^9, 
  3.78889542940858*^9, 3.7891324643195047`*^9, 3.789133142431842*^9, 
  3.789135640832869*^9, 3.789143070729986*^9, 3.7893197324663906`*^9, 
  3.7894059259585876`*^9, 3.789406026634818*^9, 3.7894062307247105`*^9, 
  3.78940630620974*^9, 3.7894063383995447`*^9, 3.7894064933074136`*^9, 
  3.789489170680519*^9, 3.7894892966605005`*^9, 3.789489436697451*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.7800619575026927`*^9, 3.788894846333558*^9, 
  3.78889542940858*^9, 3.7891324643195047`*^9, 3.789133142431842*^9, 
  3.789135640832869*^9, 3.789143070729986*^9, 3.7893197324663906`*^9, 
  3.7894059259585876`*^9, 3.789406026634818*^9, 3.7894062307247105`*^9, 
  3.78940630620974*^9, 3.7894063383995447`*^9, 3.7894064933074136`*^9, 
  3.789489170680519*^9, 3.7894892966605005`*^9, 3.7894894367014513`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Export", "Section",
 CellChangeTimes->{{3.511177531124222*^9, 3.511177531860264*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "x", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x2", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "2", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x3", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "3", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{"x4", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "4", "]"}]}], ",", 
    RowBox[{
     RowBox[{"x5", "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "5", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "6", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "7", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "8", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "9", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x5", "'"}], "[", "t", "]"}], ":=", 
     RowBox[{"x", "[", "10", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "1", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "2", "]"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "3", "]"}]}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "''"}], "[", "t", "]"}], ":=", 
     RowBox[{"a", "[", "4", "]"}]}]}], "}"}], ";"}]}], "Input",
 CellChangeTimes->{{3.523274663953125*^9, 3.5232746810625*^9}, {
   3.52327495384375*^9, 3.5232750456875*^9}, {3.5232901581875*^9, 
   3.523290214203125*^9}, {3.523380407609375*^9, 3.52338042590625*^9}, {
   3.523380594984375*^9, 3.523380620390625*^9}, {3.538749586056141*^9, 
   3.5387495922311406`*^9}, {3.538835825326691*^9, 3.538835847437691*^9}, {
   3.5431437314051914`*^9, 3.5431437394361916`*^9}, {3.543928827586776*^9, 
   3.5439288325927753`*^9}, {3.5550941946856728`*^9, 
   3.5550942017716727`*^9}, {3.5550942703126726`*^9, 3.555094363648673*^9}, {
   3.555178321819333*^9, 3.555178343561333*^9}, {3.5551783963133335`*^9, 
   3.5551784047093334`*^9}, {3.5553271072898808`*^9, 3.55532714308346*^9}, {
   3.5558698844658337`*^9, 3.5558698887528334`*^9}, {3.5558699258888335`*^9, 
   3.5558699260948334`*^9}, 3.7404899945838785`*^9, 3.763985685557726*^9, {
   3.766839059428672*^9, 3.7668390599897084`*^9}, 3.7668476276088934`*^9, {
   3.766855781789193*^9, 3.7668557985722*^9}, {3.7668571709820786`*^9, 
   3.766857216438575*^9}, {3.7668578392979937`*^9, 3.766857879684413*^9}, {
   3.7778168024551315`*^9, 3.777816803045433*^9}, {3.7778174695229225`*^9, 
   3.77781746976779*^9}, {3.777817949380939*^9, 3.777817958461069*^9}, {
   3.777918448666876*^9, 3.777918492002409*^9}, {3.7794549884541492`*^9, 
   3.7794550167904944`*^9}, {3.7888946375040593`*^9, 3.788894659039651*^9}, {
   3.7894064132518044`*^9, 3.789406452063593*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "toplevelfolder", " ", "=", " ", 
   "\"\<Z:\\\\Member Folders\\\\Mark \
Yeatman\\\\Codes\\\\Matlab\\\\StandardizedSimCode\\\\Derivations\\\\\
ToMatlabOutputs\\\\\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"configfolder", " ", "=", " ", "\"\<ProsthesisTestBench\\\\\>\""}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.772280051875898*^9, 3.7722800532501335`*^9}, 3.7724712823764505`*^9, {
   3.772544319812922*^9, 3.7725443260688457`*^9}, {3.7778180168305063`*^9, 
   3.777818063490815*^9}, {3.7778183190733128`*^9, 3.7778183490397363`*^9}, {
   3.7778185165591946`*^9, 3.7778185469889517`*^9}, {3.777901679193923*^9, 
   3.7779017110013313`*^9}, {3.777902180651893*^9, 3.7779021807915163`*^9}, {
   3.777902374229483*^9, 3.7779023749006786`*^9}, {3.7779186427059574`*^9, 
   3.77791865903345*^9}, {3.7794515798327675`*^9, 3.7794515819632196`*^9}, 
   3.779451894721938*^9, 3.78889459204217*^9, {3.7888946656476336`*^9, 
   3.788894675935608*^9}, {3.78889475456151*^9, 3.7888947552794995`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"write", " ", "kinematic", " ", "functions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<KinematicFunctions\\\\\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, 3.77781796835398*^9, {
   3.7778183470696664`*^9, 3.777818352019532*^9}, {3.777818551118823*^9, 
   3.7778185530189786`*^9}, {3.7779022711896954`*^9, 3.777902271430052*^9}, {
   3.7779023029510117`*^9, 3.7779023267423706`*^9}, 3.777908971959654*^9, {
   3.777918670936535*^9, 3.77791867154746*^9}, 3.7888945949061604`*^9}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"twAnkle", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Ankle_pos.m\>\""}], "]"}], ",", "posAnkle"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"twKnee", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_pos.m\>\""}], "]"}], ",", "posKnee"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"twHeel", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Heel_pos.m\>\""}], "]"}], ",", "posHeel"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"twToe", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Toe_pos.m\>\""}], "]"}], ",", "posToe"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, 3.77781796835398*^9, {
   3.7778183470696664`*^9, 3.777818352019532*^9}, {3.777818551118823*^9, 
   3.7778185530189786`*^9}, {3.7779022711896954`*^9, 3.777902271430052*^9}, {
   3.7779023029510117`*^9, 3.7779023267423706`*^9}, 3.777908971959654*^9, 
   3.7779187013015394`*^9, 3.777923815346425*^9, {3.777923928496435*^9, 
   3.7779240968988113`*^9}, {3.7779884391398573`*^9, 
   3.7779884396993933`*^9}, {3.7782425358567886`*^9, 
   3.7782425361160927`*^9}, {3.7782425827531133`*^9, 3.778242606305738*^9}, {
   3.7782428823067017`*^9, 3.7782428864825225`*^9}, {3.7794515893727703`*^9, 
   3.779451601312634*^9}, 3.7888945981011553`*^9, {3.7888946818405647`*^9, 
   3.788894698943493*^9}, {3.789132255518828*^9, 3.789132322478117*^9}, {
   3.789132355950748*^9, 3.7891323645416145`*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vAnkle", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Ankle_vel.m\>\""}], "]"}], ",", "velAnkle"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vKnee", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_vel.m\>\""}], "]"}], ",", "velKnee"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vHeel", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Heel_vel.m\>\""}], "]"}], ",", "velHeel"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"vToe", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Toe_vel.m\>\""}], "]"}], ",", "velToe"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.772548722806535*^9, 
   3.77254872383126*^9}, 3.777918704712248*^9, 3.777923826439192*^9, {
   3.777924106493198*^9, 3.7779241584383144`*^9}, {3.777988465093164*^9, 
   3.7779884676214*^9}, {3.778242612432727*^9, 3.7782426195379806`*^9}, {
   3.7782428897128716`*^9, 3.778242890402033*^9}, {3.779451593182459*^9, 
   3.7794516007126365`*^9}, 3.78889460059912*^9, {3.78889469358351*^9, 
   3.788894708767473*^9}, {3.789132308079239*^9, 3.789132308351269*^9}, {
   3.789132369501561*^9, 3.789132404190213*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js1", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Ankle_Jacobian.m\>\""}], "]"}], ",", "js1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"Js0", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<Knee_Jacobian.m\>\""}], "]"}], ",", "js0"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.777049991562661*^9, 
   3.777049992219898*^9}, 3.777118662325981*^9, 3.777818358659815*^9, {
   3.777907754094847*^9, 3.777907764853856*^9}, 3.777918710428299*^9, 
   3.777923820641664*^9, {3.777924179365828*^9, 3.7779243352258377`*^9}, 
   3.778084369319332*^9, 3.7782425294915514`*^9, {3.7794515970331397`*^9, 
   3.7794515992161913`*^9}, 3.7888946029581404`*^9, {3.7888947133924294`*^9, 
   3.7888947254883947`*^9}, {3.789133104116314*^9, 3.7891331042923117`*^9}, {
   3.789405848205355*^9, 3.7894058777764726`*^9}, {3.7894061792146063`*^9, 
   3.7894062061046224`*^9}, {3.7894065228652534`*^9, 3.789406526175194*^9}, {
   3.789406613360762*^9, 3.789406620558724*^9}}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"COM", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<COM_pos.m\>\""}], "]"}], ",", "posCoM"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"ddCOM", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<COM_accel.m\>\""}], "]"}], ",", "ddCoM"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.7668473967462254`*^9, 3.7668474024564037`*^9}, {
   3.7668474695593543`*^9, 3.7668474697558975`*^9}, {3.766847784087072*^9, 
   3.7668478419757366`*^9}, {3.7668480710616474`*^9, 3.766848091110597*^9}, {
   3.7668504617836914`*^9, 3.7668504802969027`*^9}, {3.7668506719744034`*^9, 
   3.766850685815195*^9}, {3.766853071465933*^9, 3.7668530716932955`*^9}, {
   3.7668531185865545`*^9, 3.7668531205381513`*^9}, {3.7668533695450726`*^9, 
   3.766853390729023*^9}, {3.7668540747274265`*^9, 3.7668540786947384`*^9}, {
   3.766854399462119*^9, 3.766854477603095*^9}, 3.7668545798447995`*^9, {
   3.766854952258715*^9, 3.766854973488822*^9}, {3.766855039073496*^9, 
   3.766855052017766*^9}, {3.7686547375662546`*^9, 3.7686547427169833`*^9}, {
   3.771605832033862*^9, 3.771605839537809*^9}, {3.772277780441394*^9, 
   3.772277856473636*^9}, {3.772279549692916*^9, 3.7722795606940947`*^9}, {
   3.7722796223555145`*^9, 3.772279622675598*^9}, 3.772279923053319*^9, {
   3.7725441926935205`*^9, 3.772544235537221*^9}, {3.777049991562661*^9, 
   3.777049992219898*^9}, 3.777118662325981*^9, 3.777818358659815*^9, {
   3.777907754094847*^9, 3.777907764853856*^9}, {3.777908921148636*^9, 
   3.777908921408777*^9}, 3.7888946059101076`*^9}],

Cell[BoxData[{
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"L1", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<SpringLength.m\>\""}], "]"}], ",", "l1"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"L1dot", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<SpringVelocity.m\>\""}], "]"}], ",", 
   "l1dot"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"LJacob1", ",", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<SpringJacobian.m\>\""}], "]"}], ",", 
   "lJacob"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7794558392339535`*^9, 3.779455849393877*^9}, 
   3.788894609881126*^9, {3.7893196897827578`*^9, 3.7893197031531515`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"write", " ", "energy", " ", "functions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<EnergyFunctions\\\\\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"KE", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Kinetic_energy.m\>\""}], "]"}], ",", "Ke"}],
     "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"PE", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<Potential_energy.m\>\""}], "]"}], ",", 
     "Pe"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7668475432072716`*^9, 3.7668475477684174`*^9}, 
   3.7668504338042464`*^9, {3.7668530695298395`*^9, 3.7668530798987293`*^9}, {
   3.7668533594830723`*^9, 3.766853367639927*^9}, {3.766854483188921*^9, 
   3.766854505253061*^9}, 3.7668545789148684`*^9, 3.766854995282686*^9, 
   3.7686547531060104`*^9, {3.769432665825548*^9, 3.7694326790870624`*^9}, 
   3.771605846371463*^9, {3.7722797472343807`*^9, 3.7722797477158823`*^9}, 
   3.772280059316539*^9, 3.7724712854977274`*^9, 3.7725443337349963`*^9, {
   3.777818087260631*^9, 3.7778180981406755`*^9}, {3.7778181871999645`*^9, 
   3.7778181943064384`*^9}, {3.777818558428881*^9, 3.777818559738714*^9}, {
   3.777902333908635*^9, 3.777902334120043*^9}, {3.777904101226956*^9, 
   3.777904103465877*^9}, 3.7888946137741175`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"write", " ", "dynamics", " ", "matrices"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"folder", " ", "=", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{
      "toplevelfolder", ",", "configfolder", ",", 
       "\"\<DynamicsFunctions\\\\\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
       RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
       RowBox[{"(*", 
        RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null",
        " ", 
       RowBox[{"(*", 
        RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
       RowBox[{
       "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
      " ", 
      RowBox[{"(*", 
       RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Mmatrix", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<M_matrix.m\>\""}], "]"}], ",", "M"}], "]"}],
    "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Cmtx", ",", " ", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<C_matrix.m\>\""}], "]"}], ",", "Cmat"}], 
    "]"}], "\[IndentingNewLine]", 
   RowBox[{"WriteMatlab", "[", 
    RowBox[{"Nvect", ",", 
     RowBox[{"StringJoin", "[", 
      RowBox[{"folder", ",", "\"\<G_matrix.m\>\""}], "]"}], ",", "G"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.766847369204723*^9, 3.7668473878355303`*^9}, {
   3.766847585864328*^9, 3.7668476038959827`*^9}, {3.766850014475005*^9, 
   3.766850030554435*^9}, {3.7668513704203095`*^9, 3.7668514120052505`*^9}, {
   3.766852039183888*^9, 3.7668520503689537`*^9}, {3.7668522727052794`*^9, 
   3.766852275008807*^9}, {3.766853046421412*^9, 3.766853064043687*^9}, {
   3.7668533011781917`*^9, 3.766853344089145*^9}, {3.7668545084217052`*^9, 
   3.7668545783400555`*^9}, {3.7668549993942747`*^9, 3.766855030304912*^9}, {
   3.7669298825923967`*^9, 3.766929952780774*^9}, 3.768654755038561*^9, {
   3.7694326966967845`*^9, 3.769432710767831*^9}, {3.769432884128147*^9, 
   3.769432884270279*^9}, 3.7716058486581182`*^9, {3.772279044021554*^9, 
   3.772279091175994*^9}, 3.772280060947896*^9, 3.772471289153407*^9, 
   3.7725443358141966`*^9, {3.7778181024172745`*^9, 3.7778181249408045`*^9}, {
   3.777818172173375*^9, 3.777818173420313*^9}, {3.7778185620621676`*^9, 
   3.7778185637737646`*^9}, {3.7779023361173224`*^9, 3.7779023363458242`*^9}, 
   3.7888946171900806`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"folder", " ", "=", " ", 
   RowBox[{"StringJoin", "[", 
    RowBox[{
    "toplevelfolder", ",", "configfolder", ",", 
     "\"\<ConstraintFunctions\\\\\>\""}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"With", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"dirname", "=", "folder"}], "}"}], ",", 
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{"FileType", "[", "dirname", "]"}], ",", "None", ",", 
     RowBox[{"CreateDirectory", "[", "dirname", "]"}], " ", 
     RowBox[{"(*", 
      RowBox[{"create", " ", "dir"}], "*)"}], ",", "Directory", ",", "Null", 
     " ", 
     RowBox[{"(*", 
      RowBox[{"do", " ", "nothing"}], "*)"}], ",", "File", ",", 
     RowBox[{
     "Print", "[", "\"\<File with same name already exists!!\>\"", "]"}]}], 
    " ", 
    RowBox[{"(*", 
     RowBox[{"error", "!"}], "*)"}], "]"}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"AHip", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<AHip_matrix.m\>\""}], "]"}], ",", "Ahip"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteMatlab", "[", 
  RowBox[{"AdotHip", ",", 
   RowBox[{"StringJoin", "[", 
    RowBox[{"folder", ",", "\"\<AdotHip_matrix.m\>\""}], "]"}], ",", 
   "Adothip"}], "]"}]}], "Input",
 CellChangeTimes->{{3.780062072251753*^9, 3.7800621009912167`*^9}, 
   3.7888946205430746`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unset", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x1", "[", "t", "]"}], ",", " ", 
     RowBox[{"x2", "[", "t", "]"}], ",", " ", 
     RowBox[{"x3", "[", "t", "]"}], ",", " ", 
     RowBox[{"x4", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x1", "''"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x2", "''"}], "[", "t", "]"}], ",", " ", 
     RowBox[{
      RowBox[{"x3", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"x4", "''"}], "[", "t", "]"}]}], "}"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.766934307338765*^9, 3.7669344074321623`*^9}, {
  3.77945161420302*^9, 3.7794516209924507`*^9}, {3.7888947399035716`*^9, 
  3.788894744671524*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1920, 997},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
PrintingCopies->1,
PrintingPageRange->{Automatic, Automatic},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
Magnification:>0.9 Inherited,
FrontEndVersion->"10.4 for Microsoft Windows (64-bit) (February 25, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[567, 22, 504, 10, 74, "Subsubtitle"],
Cell[CellGroupData[{
Cell[1096, 36, 279, 4, 61, "Section"],
Cell[1378, 42, 1037, 31, 170, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2452, 78, 204, 2, 61, "Section"],
Cell[CellGroupData[{
Cell[2681, 84, 3181, 65, 70, "Input"],
Cell[5865, 151, 896, 20, 28, "Output"]
}, Open  ]],
Cell[6776, 174, 5331, 127, 250, "Input"],
Cell[12110, 303, 5721, 132, 250, "Input"],
Cell[CellGroupData[{
Cell[17856, 439, 2695, 60, 210, "Input"],
Cell[20554, 501, 3367, 93, 106, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23958, 599, 1925, 49, 110, "Input"],
Cell[25886, 650, 665, 13, 21, "Message"],
Cell[26554, 665, 571, 11, 19, "Message"],
Cell[27128, 678, 663, 13, 21, "Message"],
Cell[27794, 693, 573, 11, 19, "Message"],
Cell[28370, 706, 665, 13, 21, "Message"],
Cell[29038, 721, 573, 11, 19, "Message"],
Cell[29614, 734, 665, 13, 21, "Message"],
Cell[30282, 749, 571, 11, 19, "Message"]
}, Open  ]],
Cell[30868, 763, 1219, 36, 110, "Input"],
Cell[32090, 801, 1126, 32, 90, "Input"],
Cell[33219, 835, 3394, 81, 70, "Input"],
Cell[36616, 918, 302, 6, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36955, 929, 213, 3, 61, "Section"],
Cell[CellGroupData[{
Cell[37193, 936, 221, 3, 35, "Subsubsection"],
Cell[37417, 941, 2771, 73, 70, "Input"],
Cell[CellGroupData[{
Cell[40213, 1018, 675, 15, 29, "Input"],
Cell[40891, 1035, 21788, 573, 159, "Output"]
}, Open  ]],
Cell[62694, 1611, 292, 8, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[63023, 1624, 216, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[63264, 1631, 95, 2, 29, "Input"],
Cell[63362, 1635, 651, 10, 28, "Output"]
}, Open  ]],
Cell[64028, 1648, 2876, 75, 90, "Input"],
Cell[66907, 1725, 297, 6, 29, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67241, 1736, 326, 4, 35, "Subsubsection"],
Cell[67570, 1742, 1844, 44, 70, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69451, 1791, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[69576, 1796, 2616, 51, 50, "Input"],
Cell[72195, 1849, 3735, 97, 94, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[75967, 1951, 347, 10, 29, "Input"],
Cell[76317, 1963, 1440, 37, 65, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77806, 2006, 260, 3, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[78091, 2013, 1944, 38, 50, "Input"],
Cell[80038, 2053, 871, 20, 28, "Output"],
Cell[80912, 2075, 3028, 82, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[83977, 2162, 2309, 50, 70, "Input"],
Cell[86289, 2214, 2178, 58, 52, "Output"],
Cell[88470, 2274, 8374, 224, 152, "Output"],
Cell[96847, 2500, 11798, 303, 157, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[108694, 2809, 427, 6, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[109146, 2819, 1034, 30, 70, "Input"],
Cell[110183, 2851, 668, 14, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110888, 2870, 208, 3, 50, "Input"],
Cell[111099, 2875, 1070, 24, 70, "Output"],
Cell[112172, 2901, 1072, 24, 67, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[113305, 2932, 91, 1, 61, "Section"],
Cell[113399, 2935, 3203, 75, 50, "Input"],
Cell[116605, 3012, 2011, 31, 50, "Input"],
Cell[118619, 3045, 2423, 48, 70, "Input"],
Cell[121045, 3095, 2608, 45, 90, "Input"],
Cell[123656, 3142, 2328, 41, 90, "Input"],
Cell[125987, 3185, 2098, 33, 50, "Input"],
Cell[128088, 3220, 1648, 27, 50, "Input"],
Cell[129739, 3249, 747, 17, 70, "Input"],
Cell[130489, 3268, 2273, 50, 110, "Input"],
Cell[132765, 3320, 2752, 60, 130, "Input"],
Cell[135520, 3382, 1384, 37, 90, "Input"],
Cell[136907, 3421, 1003, 27, 29, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

